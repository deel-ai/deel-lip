
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../initializers/">
      
      
        <link rel="next" href="../losses/">
      
      
      <link rel="icon" href="../../assets/lip_logo.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.6">
    
    
      
        <title>deel.lip.layers - DEEL-LIP</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.35e1ed30.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.356b1318.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../css/custom.css">
    
      <link rel="stylesheet" href="../../css/ansi-colours.css">
    
      <link rel="stylesheet" href="../../css/jupyter-cells.css">
    
      <link rel="stylesheet" href="../../css/pandas-dataframe.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="dark" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#deel.lip.layers" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="DEEL-LIP" class="md-header__button md-logo" aria-label="DEEL-LIP" data-md-component="logo">
      
  <img src="../../assets/lip_logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            DEEL-LIP
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              deel.lip.layers
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="dark" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
</form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/deel-ai/deel-lip" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    deel-ai/deel-lip
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="DEEL-LIP" class="md-nav__button md-logo" aria-label="DEEL-LIP" data-md-component="logo">
      
  <img src="../../assets/lip_logo.png" alt="logo">

    </a>
    DEEL-LIP
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/deel-ai/deel-lip" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    deel-ai/deel-lip
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../activations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    deel.lip.activations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../callbacks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    deel.lip.callbacks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../constraints/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    deel.lip.constraints
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../initializers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    deel.lip.initializers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    deel.lip.layers
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    deel.lip.layers
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#deel.lip.layers" class="md-nav__link">
    layers
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deel.lip.layers.activations" class="md-nav__link">
    activations
  </a>
  
    <nav class="md-nav" aria-label="activations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deel.lip.layers.activations.FullSort" class="md-nav__link">
    FullSort
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deel.lip.layers.activations.GroupSort" class="md-nav__link">
    GroupSort
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deel.lip.layers.activations.GroupSort2" class="md-nav__link">
    GroupSort2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deel.lip.layers.activations.Householder" class="md-nav__link">
    Householder
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deel.lip.layers.activations.MaxMin" class="md-nav__link">
    MaxMin
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deel.lip.layers.activations.PReLUlip" class="md-nav__link">
    PReLUlip()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deel.lip.layers.base_layer" class="md-nav__link">
    base_layer
  </a>
  
    <nav class="md-nav" aria-label="base_layer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deel.lip.layers.base_layer.Condensable" class="md-nav__link">
    Condensable
  </a>
  
    <nav class="md-nav" aria-label="Condensable">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deel.lip.layers.base_layer.Condensable.condense" class="md-nav__link">
    condense()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deel.lip.layers.base_layer.Condensable.vanilla_export" class="md-nav__link">
    vanilla_export()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deel.lip.layers.base_layer.LipschitzLayer" class="md-nav__link">
    LipschitzLayer
  </a>
  
    <nav class="md-nav" aria-label="LipschitzLayer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deel.lip.layers.base_layer.LipschitzLayer.coef_lip" class="md-nav__link">
    coef_lip
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deel.lip.layers.base_layer.LipschitzLayer.k_coef_lip" class="md-nav__link">
    k_coef_lip
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deel.lip.layers.base_layer.LipschitzLayer.set_klip_factor" class="md-nav__link">
    set_klip_factor()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deel.lip.layers.convolutional" class="md-nav__link">
    convolutional
  </a>
  
    <nav class="md-nav" aria-label="convolutional">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deel.lip.layers.convolutional.FrobeniusConv2D" class="md-nav__link">
    FrobeniusConv2D
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deel.lip.layers.convolutional.SpectralConv2D" class="md-nav__link">
    SpectralConv2D
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deel.lip.layers.convolutional.SpectralConv2DTranspose" class="md-nav__link">
    SpectralConv2DTranspose
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deel.lip.layers.dense" class="md-nav__link">
    dense
  </a>
  
    <nav class="md-nav" aria-label="dense">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deel.lip.layers.dense.FrobeniusDense" class="md-nav__link">
    FrobeniusDense
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deel.lip.layers.dense.SpectralDense" class="md-nav__link">
    SpectralDense
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deel.lip.layers.pooling" class="md-nav__link">
    pooling
  </a>
  
    <nav class="md-nav" aria-label="pooling">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deel.lip.layers.pooling.InvertibleDownSampling" class="md-nav__link">
    InvertibleDownSampling
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deel.lip.layers.pooling.InvertibleUpSampling" class="md-nav__link">
    InvertibleUpSampling
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deel.lip.layers.pooling.ScaledAveragePooling2D" class="md-nav__link">
    ScaledAveragePooling2D
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deel.lip.layers.pooling.ScaledGlobalAveragePooling2D" class="md-nav__link">
    ScaledGlobalAveragePooling2D
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deel.lip.layers.pooling.ScaledGlobalL2NormPooling2D" class="md-nav__link">
    ScaledGlobalL2NormPooling2D
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deel.lip.layers.pooling.ScaledL2NormPooling2D" class="md-nav__link">
    ScaledL2NormPooling2D
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deel.lip.layers.unconstrained" class="md-nav__link">
    unconstrained
  </a>
  
    <nav class="md-nav" aria-label="unconstrained">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deel.lip.layers.unconstrained.PadConv2D" class="md-nav__link">
    PadConv2D
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../losses/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    deel.lip.losses
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../metrics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    deel.lip.metrics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../model/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    deel.lip.model
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../normalizers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    deel.lip.normalizers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    deel.lip.utils
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/Getting_started_1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting started 1 - Creating a 1-Lipschitz neural network
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/demo0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Demo 0: Example & Usage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/demo1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Demo 1: Wasserstein distance estimation on toy example
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/demo2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Demo 2: HKR Classifier on toy dataset
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/demo3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Demo 3: HKR Classifier on MNIST dataset
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/demo4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Demo 4: HKR Multiclass and fooling
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#deel.lip.layers" class="md-nav__link">
    layers
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deel.lip.layers.activations" class="md-nav__link">
    activations
  </a>
  
    <nav class="md-nav" aria-label="activations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deel.lip.layers.activations.FullSort" class="md-nav__link">
    FullSort
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deel.lip.layers.activations.GroupSort" class="md-nav__link">
    GroupSort
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deel.lip.layers.activations.GroupSort2" class="md-nav__link">
    GroupSort2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deel.lip.layers.activations.Householder" class="md-nav__link">
    Householder
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deel.lip.layers.activations.MaxMin" class="md-nav__link">
    MaxMin
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deel.lip.layers.activations.PReLUlip" class="md-nav__link">
    PReLUlip()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deel.lip.layers.base_layer" class="md-nav__link">
    base_layer
  </a>
  
    <nav class="md-nav" aria-label="base_layer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deel.lip.layers.base_layer.Condensable" class="md-nav__link">
    Condensable
  </a>
  
    <nav class="md-nav" aria-label="Condensable">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deel.lip.layers.base_layer.Condensable.condense" class="md-nav__link">
    condense()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deel.lip.layers.base_layer.Condensable.vanilla_export" class="md-nav__link">
    vanilla_export()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deel.lip.layers.base_layer.LipschitzLayer" class="md-nav__link">
    LipschitzLayer
  </a>
  
    <nav class="md-nav" aria-label="LipschitzLayer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deel.lip.layers.base_layer.LipschitzLayer.coef_lip" class="md-nav__link">
    coef_lip
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deel.lip.layers.base_layer.LipschitzLayer.k_coef_lip" class="md-nav__link">
    k_coef_lip
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deel.lip.layers.base_layer.LipschitzLayer.set_klip_factor" class="md-nav__link">
    set_klip_factor()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deel.lip.layers.convolutional" class="md-nav__link">
    convolutional
  </a>
  
    <nav class="md-nav" aria-label="convolutional">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deel.lip.layers.convolutional.FrobeniusConv2D" class="md-nav__link">
    FrobeniusConv2D
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deel.lip.layers.convolutional.SpectralConv2D" class="md-nav__link">
    SpectralConv2D
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deel.lip.layers.convolutional.SpectralConv2DTranspose" class="md-nav__link">
    SpectralConv2DTranspose
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deel.lip.layers.dense" class="md-nav__link">
    dense
  </a>
  
    <nav class="md-nav" aria-label="dense">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deel.lip.layers.dense.FrobeniusDense" class="md-nav__link">
    FrobeniusDense
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deel.lip.layers.dense.SpectralDense" class="md-nav__link">
    SpectralDense
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deel.lip.layers.pooling" class="md-nav__link">
    pooling
  </a>
  
    <nav class="md-nav" aria-label="pooling">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deel.lip.layers.pooling.InvertibleDownSampling" class="md-nav__link">
    InvertibleDownSampling
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deel.lip.layers.pooling.InvertibleUpSampling" class="md-nav__link">
    InvertibleUpSampling
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deel.lip.layers.pooling.ScaledAveragePooling2D" class="md-nav__link">
    ScaledAveragePooling2D
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deel.lip.layers.pooling.ScaledGlobalAveragePooling2D" class="md-nav__link">
    ScaledGlobalAveragePooling2D
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deel.lip.layers.pooling.ScaledGlobalL2NormPooling2D" class="md-nav__link">
    ScaledGlobalL2NormPooling2D
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deel.lip.layers.pooling.ScaledL2NormPooling2D" class="md-nav__link">
    ScaledL2NormPooling2D
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deel.lip.layers.unconstrained" class="md-nav__link">
    unconstrained
  </a>
  
    <nav class="md-nav" aria-label="unconstrained">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deel.lip.layers.unconstrained.PadConv2D" class="md-nav__link">
    PadConv2D
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>deel.lip.layers</h1>

<div class="doc doc-object doc-module">



<a id="deel.lip.layers"></a>
  <div class="doc doc-contents first">
  
      <p>The submodule <code>deel.lip.layers</code> contains all custom Keras layers to build
Lipschitz-constrained neural networks. They all inherit from <code>keras.layers.Layer</code> from
Keras API.</p>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-module">




<h2 id="deel.lip.layers.activations" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">activations</span>


<a href="#deel.lip.layers.activations" class="headerlink" title="Permanent link">&para;</a></h2>

  <div class="doc doc-contents ">
  
      <p>This module contains extra activation functions which respect the Lipschitz constant.
It can be added as a layer, or it can be used in the "activation" params for other
layers.</p>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">




<h3 id="deel.lip.layers.activations.FullSort" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">FullSort</span>


<a href="#deel.lip.layers.activations.FullSort" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">FullSort</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="deel.lip.layers.activations.GroupSort" href="#deel.lip.layers.activations.GroupSort">GroupSort</a></code></p>

  
      <p>FullSort activation. Special case of GroupSort where the entire input is sorted.</p>

<details class="input-shape" open>
  <summary>Input shape</summary>
  <p>Arbitrary. Use the keyword argument <code>input_shape</code> (tuple of integers, does
not include the samples axis) when using this layer as the first layer in a
model.</p>
</details>
<details class="output-shape" open>
  <summary>Output shape</summary>
  <p>Same size as input.</p>
</details>
                <details class="quote">
                  <summary>Source code in <code>deel/lip/layers/activations.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    FullSort activation. Special case of GroupSort where the entire input is sorted.</span>

<span class="sd">    Input shape:</span>
<span class="sd">        Arbitrary. Use the keyword argument `input_shape` (tuple of integers, does</span>
<span class="sd">        not include the samples axis) when using this layer as the first layer in a</span>
<span class="sd">        model.</span>

<span class="sd">    Output shape:</span>
<span class="sd">        Same size as input.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;n&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h3 id="deel.lip.layers.activations.GroupSort" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">GroupSort</span>


<a href="#deel.lip.layers.activations.GroupSort" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">GroupSort</span><span class="p">(</span>
    <span class="n">n</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">data_format</span><span class="o">=</span><span class="s2">&quot;channels_last&quot;</span><span class="p">,</span>
    <span class="n">k_coef_lip</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="tensorflow.keras.layers.Layer">Layer</span></code>, <code><a class="autorefs autorefs-internal" title="deel.lip.layers.base_layer.LipschitzLayer" href="#deel.lip.layers.base_layer.LipschitzLayer">LipschitzLayer</a></code></p>

  
      <p>GroupSort activation</p>



  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b> DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>n</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>group size used when sorting. When None group size is set to input
size (fullSort behavior)</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>int</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>data_format</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>either channels_first or channels_last</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>&#39;channels_last&#39;</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>k_coef_lip</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>the lipschitz coefficient to be enforced</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>float</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>1.0</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>**kwargs</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>params passed to layers (named fashion)</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>{}</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

<details class="input-shape" open>
  <summary>Input shape</summary>
  <p>Arbitrary. Use the keyword argument <code>input_shape</code> (tuple of integers, does
not include the samples axis) when using this layer as the first layer in a
model.</p>
</details>
<details class="output-shape" open>
  <summary>Output shape</summary>
  <p>Same size as input.</p>
</details>
                <details class="quote">
                  <summary>Source code in <code>deel/lip/layers/activations.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">data_format</span><span class="o">=</span><span class="s2">&quot;channels_last&quot;</span><span class="p">,</span> <span class="n">k_coef_lip</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    GroupSort activation</span>

<span class="sd">    Args:</span>
<span class="sd">        n (int): group size used when sorting. When None group size is set to input</span>
<span class="sd">            size (fullSort behavior)</span>
<span class="sd">        data_format (str): either channels_first or channels_last</span>
<span class="sd">        k_coef_lip (float): the lipschitz coefficient to be enforced</span>
<span class="sd">        **kwargs: params passed to layers (named fashion)</span>

<span class="sd">    Input shape:</span>
<span class="sd">        Arbitrary. Use the keyword argument `input_shape` (tuple of integers, does</span>
<span class="sd">        not include the samples axis) when using this layer as the first layer in a</span>
<span class="sd">        model.</span>

<span class="sd">    Output shape:</span>
<span class="sd">        Same size as input.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">set_klip_factor</span><span class="p">(</span><span class="n">k_coef_lip</span><span class="p">)</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">GroupSort</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">data_format</span> <span class="o">==</span> <span class="s2">&quot;channels_last&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">channel_axis</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">elif</span> <span class="n">data_format</span> <span class="o">==</span> <span class="s2">&quot;channels_first&quot;</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="s2">&quot;channels_first not implemented for GroupSort activation&quot;</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;data format not understood&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="n">n</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data_format</span> <span class="o">=</span> <span class="n">data_format</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h3 id="deel.lip.layers.activations.GroupSort2" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">GroupSort2</span>


<a href="#deel.lip.layers.activations.GroupSort2" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">GroupSort2</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="deel.lip.layers.activations.GroupSort" href="#deel.lip.layers.activations.GroupSort">GroupSort</a></code></p>

  
      <p>GroupSort2 activation. Special case of GroupSort with group of size 2.</p>

<details class="input-shape" open>
  <summary>Input shape</summary>
  <p>Arbitrary. Use the keyword argument <code>input_shape</code> (tuple of integers, does
not include the samples axis) when using this layer as the first layer in a
model.</p>
</details>
<details class="output-shape" open>
  <summary>Output shape</summary>
  <p>Same size as input.</p>
</details>
                <details class="quote">
                  <summary>Source code in <code>deel/lip/layers/activations.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    GroupSort2 activation. Special case of GroupSort with group of size 2.</span>

<span class="sd">    Input shape:</span>
<span class="sd">        Arbitrary. Use the keyword argument `input_shape` (tuple of integers, does</span>
<span class="sd">        not include the samples axis) when using this layer as the first layer in a</span>
<span class="sd">        model.</span>

<span class="sd">    Output shape:</span>
<span class="sd">        Same size as input.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;n&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h3 id="deel.lip.layers.activations.Householder" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">Householder</span>


<a href="#deel.lip.layers.activations.Householder" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">Householder</span><span class="p">(</span>
    <span class="n">data_format</span><span class="o">=</span><span class="s2">&quot;channels_last&quot;</span><span class="p">,</span>
    <span class="n">k_coef_lip</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">theta_initializer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="tensorflow.keras.layers.Layer">Layer</span></code>, <code><a class="autorefs autorefs-internal" title="deel.lip.layers.base_layer.LipschitzLayer" href="#deel.lip.layers.base_layer.LipschitzLayer">LipschitzLayer</a></code></p>

  
      <p>Householder activation:
<a href="https://openreview.net/pdf?id=tD7eCtaSkR">this review</a>
From <a href="https://github.com/singlasahil14/SOC">this repository</a></p>



  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b> DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data_format</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>either channels_first or channels_last. Only
channels_last is supported.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>&#39;channels_last&#39;</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>k_coef_lip</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>The lipschitz coefficient to be enforced.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>1.0</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>theta_initializer</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>initializer for the angle theta of reflection. Defaults
to pi/2, which corresponds to GroupSort2.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>**kwargs</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>parameters passed to the <code>tf.keras.layers.Layer</code>.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>{}</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

<details class="input-shape" open>
  <summary>Input shape</summary>
  <p>Arbitrary. Use the keyword argument <code>input_shape</code> (tuple of integers, does
not include the samples axis) when using this layer as the first layer in a
model.</p>
</details>
<details class="output-shape" open>
  <summary>Output shape</summary>
  <p>Same size as input.</p>
</details>
                <details class="quote">
                  <summary>Source code in <code>deel/lip/layers/activations.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">data_format</span><span class="o">=</span><span class="s2">&quot;channels_last&quot;</span><span class="p">,</span>
    <span class="n">k_coef_lip</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">theta_initializer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Householder activation:</span>
<span class="sd">    [this review](https://openreview.net/pdf?id=tD7eCtaSkR)</span>
<span class="sd">    From [this repository](https://github.com/singlasahil14/SOC)</span>

<span class="sd">    Args:</span>
<span class="sd">        data_format (str): either channels_first or channels_last. Only</span>
<span class="sd">            channels_last is supported.</span>
<span class="sd">        k_coef_lip (str): The lipschitz coefficient to be enforced.</span>
<span class="sd">        theta_initializer: initializer for the angle theta of reflection. Defaults</span>
<span class="sd">            to pi/2, which corresponds to GroupSort2.</span>
<span class="sd">        **kwargs: parameters passed to the `tf.keras.layers.Layer`.</span>

<span class="sd">    Input shape:</span>
<span class="sd">        Arbitrary. Use the keyword argument `input_shape` (tuple of integers, does</span>
<span class="sd">        not include the samples axis) when using this layer as the first layer in a</span>
<span class="sd">        model.</span>

<span class="sd">    Output shape:</span>
<span class="sd">        Same size as input.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">data_format</span> <span class="o">!=</span> <span class="s2">&quot;channels_last&quot;</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Only &#39;channels_last&#39; data format is supported&quot;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">data_format</span> <span class="o">=</span> <span class="n">data_format</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">set_klip_factor</span><span class="p">(</span><span class="n">k_coef_lip</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">theta_initializer</span> <span class="o">=</span> <span class="n">theta_initializer</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h3 id="deel.lip.layers.activations.MaxMin" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">MaxMin</span>


<a href="#deel.lip.layers.activations.MaxMin" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">MaxMin</span><span class="p">(</span>
    <span class="n">data_format</span><span class="o">=</span><span class="s2">&quot;channels_last&quot;</span><span class="p">,</span> <span class="n">k_coef_lip</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="tensorflow.keras.layers.Layer">Layer</span></code>, <code><a class="autorefs autorefs-internal" title="deel.lip.layers.base_layer.LipschitzLayer" href="#deel.lip.layers.base_layer.LipschitzLayer">LipschitzLayer</a></code></p>

  
      <p>MaxMin activation [Relu(x),reLU(-x)]</p>



  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b> DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data_format</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>either channels_first or channels_last</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>&#39;channels_last&#39;</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>k_coef_lip</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>the lipschitz coefficient to be enforced</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>float</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>1.0</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>**kwargs</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>params passed to layers (named fashion)</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>{}</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

<details class="input-shape" open>
  <summary>Input shape</summary>
  <p>Arbitrary. Use the keyword argument <code>input_shape</code> (tuple of integers, does
not include the samples axis) when using this layer as the first layer in a
model.</p>
</details>
<details class="output-shape" open>
  <summary>Output shape</summary>
  <p>Double channel size as input.</p>
</details>
<details class="references" open>
  <summary>References</summary>
  <p>([M. Blot, M. Cord, et N. Thome, « Max-min convolutional neural networks
for image classification », in 2016 IEEE International Conference on Image
Processing (ICIP), Phoenix, AZ, USA, 2016, p. 3678‑3682.)</p>
</details>
                <details class="quote">
                  <summary>Source code in <code>deel/lip/layers/activations.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_format</span><span class="o">=</span><span class="s2">&quot;channels_last&quot;</span><span class="p">,</span> <span class="n">k_coef_lip</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    MaxMin activation [Relu(x),reLU(-x)]</span>

<span class="sd">    Args:</span>
<span class="sd">        data_format (str): either channels_first or channels_last</span>
<span class="sd">        k_coef_lip (float): the lipschitz coefficient to be enforced</span>
<span class="sd">        **kwargs: params passed to layers (named fashion)</span>

<span class="sd">    Input shape:</span>
<span class="sd">        Arbitrary. Use the keyword argument `input_shape` (tuple of integers, does</span>
<span class="sd">        not include the samples axis) when using this layer as the first layer in a</span>
<span class="sd">        model.</span>

<span class="sd">    Output shape:</span>
<span class="sd">        Double channel size as input.</span>

<span class="sd">    References:</span>
<span class="sd">        ([M. Blot, M. Cord, et N. Thome, « Max-min convolutional neural networks</span>
<span class="sd">        for image classification », in 2016 IEEE International Conference on Image</span>
<span class="sd">        Processing (ICIP), Phoenix, AZ, USA, 2016, p. 3678‑3682.)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">set_klip_factor</span><span class="p">(</span><span class="n">k_coef_lip</span><span class="p">)</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">MaxMin</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">data_format</span> <span class="o">==</span> <span class="s2">&quot;channels_last&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">channel_axis</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">elif</span> <span class="n">data_format</span> <span class="o">==</span> <span class="s2">&quot;channels_first&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">channel_axis</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;data format not understood&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data_format</span> <span class="o">=</span> <span class="n">data_format</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>



<div class="doc doc-object doc-function">




<h3 id="deel.lip.layers.activations.PReLUlip" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">PReLUlip</span>


<a href="#deel.lip.layers.activations.PReLUlip" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">PReLUlip</span><span class="p">(</span><span class="n">k_coef_lip</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>PreLu activation, with Lipschitz constraint.</p>



  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b> DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>k_coef_lip</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>lipschitz coefficient to be enforced</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>float</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>1.0</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>deel/lip/layers/activations.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@register_keras_serializable</span><span class="p">(</span><span class="s2">&quot;deel-lip&quot;</span><span class="p">,</span> <span class="s2">&quot;PReLUlip&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">PReLUlip</span><span class="p">(</span><span class="n">k_coef_lip</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    PreLu activation, with Lipschitz constraint.</span>

<span class="sd">    Args:</span>
<span class="sd">        k_coef_lip (float): lipschitz coefficient to be enforced</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">PReLU</span><span class="p">(</span>
        <span class="n">alpha_constraint</span><span class="o">=</span><span class="n">MinMaxNorm</span><span class="p">(</span><span class="n">min_value</span><span class="o">=-</span><span class="n">k_coef_lip</span><span class="p">,</span> <span class="n">max_value</span><span class="o">=</span><span class="n">k_coef_lip</span><span class="p">)</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">




<h2 id="deel.lip.layers.base_layer" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">base_layer</span>


<a href="#deel.lip.layers.base_layer" class="headerlink" title="Permanent link">&para;</a></h2>

  <div class="doc doc-contents ">
  
      <p>This module extends original keras layers, in order to add k lipschitz constraint via
reparametrization. Currently, are implemented:
* Dense layer:
    as SpectralDense (and as FrobeniusDense when the layer has a single
    output)
* Conv2D layer:
    as SpectralConv2D (and as FrobeniusConv2D when the layer has a single
    output)
* AveragePooling:
    as ScaledAveragePooling
* GlobalAveragePooling2D:
    as ScaledGlobalAveragePooling2D
By default the layers are 1 Lipschitz almost everywhere, which is efficient for
wasserstein distance estimation. However for other problems (such as adversarial
robustness) the user may want to use layers that are at most 1 lipschitz, this can
be done by setting the param <code>eps_bjorck=None</code>.</p>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">




<h3 id="deel.lip.layers.base_layer.Condensable" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">Condensable</span>


<a href="#deel.lip.layers.base_layer.Condensable" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="abc.ABC">ABC</span></code></p>

  
      <p>Some Layers don't optimize directly the kernel, this means that the kernel stored
in the layer is not the kernel used to make predictions (called W_bar), To address
this, these layers can implement the condense() function that make self.kernel equal
to W_bar.
This operation also allows to turn the Lipschitz layer to its keras equivalent e.g.
The Dense layer that have the same predictions as the trained SpectralDense.</p>


  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h4 id="deel.lip.layers.base_layer.Condensable.condense" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">condense</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#deel.lip.layers.base_layer.Condensable.condense" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">condense</span><span class="p">()</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The condense operation allows to overwrite the kernel and ensure that other
variables are still consistent.
Returns:
    None</p>

          <details class="quote">
            <summary>Source code in <code>deel/lip/layers/base_layer.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
<span class="k">def</span> <span class="nf">condense</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The condense operation allows to overwrite the kernel and ensure that other</span>
<span class="sd">    variables are still consistent.</span>
<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h4 id="deel.lip.layers.base_layer.Condensable.vanilla_export" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">vanilla_export</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#deel.lip.layers.base_layer.Condensable.vanilla_export" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">vanilla_export</span><span class="p">()</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>This operation allows to turn this Layer to its super type, easing storage and
serving.
Returns:
     self as super type</p>

          <details class="quote">
            <summary>Source code in <code>deel/lip/layers/base_layer.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
<span class="k">def</span> <span class="nf">vanilla_export</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This operation allows to turn this Layer to its super type, easing storage and</span>
<span class="sd">    serving.</span>
<span class="sd">    Returns:</span>
<span class="sd">         self as super type</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h3 id="deel.lip.layers.base_layer.LipschitzLayer" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">LipschitzLayer</span>


<a href="#deel.lip.layers.base_layer.LipschitzLayer" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="abc.ABC">ABC</span></code></p>

  
      <p>This class allows to set Lipschitz factor of a layer. Lipschitz layer must inherit
this class to allow user to set the Lipschitz factor.
Warning:
     This class only regroups useful functions when developing new Lipschitz layers.
     But it does not ensure any property about the layer. This means that
     inheriting from this class won't ensure anything about the Lipschitz constant.</p>


  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">




<h4 id="deel.lip.layers.base_layer.LipschitzLayer.coef_lip" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">coef_lip</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#deel.lip.layers.base_layer.LipschitzLayer.coef_lip" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">coef_lip</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>define correction coefficient (ie. Lipschitz bound ) of the layer
( multiply the output of the layer by this constant )</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">




<h4 id="deel.lip.layers.base_layer.LipschitzLayer.k_coef_lip" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">k_coef_lip</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#deel.lip.layers.base_layer.LipschitzLayer.k_coef_lip" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">k_coef_lip</span> <span class="o">=</span> <span class="mf">1.0</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>variable used to store the lipschitz factor</p>
  </div>

</div>




<div class="doc doc-object doc-function">




<h4 id="deel.lip.layers.base_layer.LipschitzLayer.set_klip_factor" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">set_klip_factor</span>


<a href="#deel.lip.layers.base_layer.LipschitzLayer.set_klip_factor" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">set_klip_factor</span><span class="p">(</span><span class="n">klip_factor</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Allow to set the Lipschitz factor of a layer.
Args:
    klip_factor (float): the Lipschitz factor the user want to ensure.
Returns:
    None</p>

          <details class="quote">
            <summary>Source code in <code>deel/lip/layers/base_layer.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_klip_factor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">klip_factor</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Allow to set the Lipschitz factor of a layer.</span>
<span class="sd">    Args:</span>
<span class="sd">        klip_factor (float): the Lipschitz factor the user want to ensure.</span>
<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">k_coef_lip</span> <span class="o">=</span> <span class="n">klip_factor</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div>

<div class="doc doc-object doc-module">




<h2 id="deel.lip.layers.convolutional" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">convolutional</span>


<a href="#deel.lip.layers.convolutional" class="headerlink" title="Permanent link">&para;</a></h2>

  <div class="doc doc-contents ">
  
      <p>This module extends original keras layers, in order to add k lipschitz constraint via
reparametrization. Currently, are implemented:
* Dense layer:
    as SpectralDense (and as FrobeniusDense when the layer has a single
    output)
* Conv2D layer:
    as SpectralConv2D (and as FrobeniusConv2D when the layer has a single
    output)
* AveragePooling:
    as ScaledAveragePooling
* GlobalAveragePooling2D:
    as ScaledGlobalAveragePooling2D
By default the layers are 1 Lipschitz almost everywhere, which is efficient for
wasserstein distance estimation. However for other problems (such as adversarial
robustness) the user may want to use layers that are at most 1 lipschitz, this can
be done by setting the param <code>eps_bjorck=None</code>.</p>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">




<h3 id="deel.lip.layers.convolutional.FrobeniusConv2D" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">FrobeniusConv2D</span>


<a href="#deel.lip.layers.convolutional.FrobeniusConv2D" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">FrobeniusConv2D</span><span class="p">(</span>
    <span class="n">filters</span><span class="p">,</span>
    <span class="n">kernel_size</span><span class="p">,</span>
    <span class="n">strides</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">padding</span><span class="o">=</span><span class="s2">&quot;same&quot;</span><span class="p">,</span>
    <span class="n">data_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">dilation_rate</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">activation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="o">=</span><span class="n">SpectralInitializer</span><span class="p">(),</span>
    <span class="n">bias_initializer</span><span class="o">=</span><span class="s2">&quot;zeros&quot;</span><span class="p">,</span>
    <span class="n">kernel_regularizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">bias_regularizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">activity_regularizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">kernel_constraint</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">bias_constraint</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">k_coef_lip</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="tensorflow.keras.layers.Conv2D">Conv2D</span></code>, <code><a class="autorefs autorefs-internal" title="deel.lip.layers.base_layer.LipschitzLayer" href="#deel.lip.layers.base_layer.LipschitzLayer">LipschitzLayer</a></code>, <code><a class="autorefs autorefs-internal" title="deel.lip.layers.base_layer.Condensable" href="#deel.lip.layers.base_layer.Condensable">Condensable</a></code></p>

  
      <p>Same as SpectralConv2D but in the case of a single output.</p>

                <details class="quote">
                  <summary>Source code in <code>deel/lip/layers/convolutional.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">filters</span><span class="p">,</span>
    <span class="n">kernel_size</span><span class="p">,</span>
    <span class="n">strides</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">padding</span><span class="o">=</span><span class="s2">&quot;same&quot;</span><span class="p">,</span>
    <span class="n">data_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">dilation_rate</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">activation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="o">=</span><span class="n">SpectralInitializer</span><span class="p">(),</span>
    <span class="n">bias_initializer</span><span class="o">=</span><span class="s2">&quot;zeros&quot;</span><span class="p">,</span>
    <span class="n">kernel_regularizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">bias_regularizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">activity_regularizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">kernel_constraint</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">bias_constraint</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">k_coef_lip</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="k">if</span> <span class="n">strides</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;FrobeniusConv2D does not support strides&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">dilation_rate</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;FrobeniusConv2D does not support dilation rate&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">padding</span> <span class="o">!=</span> <span class="s2">&quot;same&quot;</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;FrobeniusConv2D only supports padding=&#39;same&#39;&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span>
        <span class="p">(</span><span class="n">kernel_constraint</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span>
        <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kernel_constraint</span><span class="p">,</span> <span class="n">SpectralConstraint</span><span class="p">)</span>
    <span class="p">):</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="s2">&quot;only deellip constraints are allowed as other constraints could break&quot;</span>
            <span class="s2">&quot; 1 lipschitz condition&quot;</span>
        <span class="p">)</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">FrobeniusConv2D</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">,</span>
        <span class="n">kernel_size</span><span class="o">=</span><span class="n">kernel_size</span><span class="p">,</span>
        <span class="n">strides</span><span class="o">=</span><span class="n">strides</span><span class="p">,</span>
        <span class="n">padding</span><span class="o">=</span><span class="n">padding</span><span class="p">,</span>
        <span class="n">data_format</span><span class="o">=</span><span class="n">data_format</span><span class="p">,</span>
        <span class="n">dilation_rate</span><span class="o">=</span><span class="n">dilation_rate</span><span class="p">,</span>
        <span class="n">activation</span><span class="o">=</span><span class="n">activation</span><span class="p">,</span>
        <span class="n">use_bias</span><span class="o">=</span><span class="n">use_bias</span><span class="p">,</span>
        <span class="n">kernel_initializer</span><span class="o">=</span><span class="n">kernel_initializer</span><span class="p">,</span>
        <span class="n">bias_initializer</span><span class="o">=</span><span class="n">bias_initializer</span><span class="p">,</span>
        <span class="n">kernel_regularizer</span><span class="o">=</span><span class="n">kernel_regularizer</span><span class="p">,</span>
        <span class="n">bias_regularizer</span><span class="o">=</span><span class="n">bias_regularizer</span><span class="p">,</span>
        <span class="n">activity_regularizer</span><span class="o">=</span><span class="n">activity_regularizer</span><span class="p">,</span>
        <span class="n">kernel_constraint</span><span class="o">=</span><span class="n">kernel_constraint</span><span class="p">,</span>
        <span class="n">bias_constraint</span><span class="o">=</span><span class="n">bias_constraint</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">set_klip_factor</span><span class="p">(</span><span class="n">k_coef_lip</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">wbar</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h3 id="deel.lip.layers.convolutional.SpectralConv2D" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">SpectralConv2D</span>


<a href="#deel.lip.layers.convolutional.SpectralConv2D" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">SpectralConv2D</span><span class="p">(</span>
    <span class="n">filters</span><span class="p">,</span>
    <span class="n">kernel_size</span><span class="p">,</span>
    <span class="n">strides</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">padding</span><span class="o">=</span><span class="s2">&quot;same&quot;</span><span class="p">,</span>
    <span class="n">data_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">dilation_rate</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">activation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="o">=</span><span class="n">SpectralInitializer</span><span class="p">(),</span>
    <span class="n">bias_initializer</span><span class="o">=</span><span class="s2">&quot;zeros&quot;</span><span class="p">,</span>
    <span class="n">kernel_regularizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">bias_regularizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">activity_regularizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">kernel_constraint</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">bias_constraint</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">k_coef_lip</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">eps_spectral</span><span class="o">=</span><span class="n">DEFAULT_EPS_SPECTRAL</span><span class="p">,</span>
    <span class="n">eps_bjorck</span><span class="o">=</span><span class="n">DEFAULT_EPS_BJORCK</span><span class="p">,</span>
    <span class="n">beta_bjorck</span><span class="o">=</span><span class="n">DEFAULT_BETA_BJORCK</span><span class="p">,</span>
    <span class="n">maxiter_spectral</span><span class="o">=</span><span class="n">DEFAULT_MAXITER_SPECTRAL</span><span class="p">,</span>
    <span class="n">maxiter_bjorck</span><span class="o">=</span><span class="n">DEFAULT_MAXITER_BJORCK</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="tensorflow.keras.layers.Conv2D">Conv2D</span></code>, <code><a class="autorefs autorefs-internal" title="deel.lip.layers.base_layer.LipschitzLayer" href="#deel.lip.layers.base_layer.LipschitzLayer">LipschitzLayer</a></code>, <code><a class="autorefs autorefs-internal" title="deel.lip.layers.base_layer.Condensable" href="#deel.lip.layers.base_layer.Condensable">Condensable</a></code></p>

  
      <p>This class is a Conv2D Layer constrained such that all singular of it's kernel
are 1. The computation based on Bjorck algorithm. As this is not
enough to ensure 1 Lipschitzity a coertive coefficient is applied on the
output.
The computation is done in three steps:</p>
<ol>
<li>reduce the largest singular value to 1, using iterated power method.</li>
<li>increase other singular values to 1, using Bjorck algorithm.</li>
<li>divide the output by the Lipschitz bound to ensure k Lipschitzity.</li>
</ol>



  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b> DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>filters</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Integer, the dimensionality of the output space
(i.e. the number of output filters in the convolution).</p>
            </div>
            <p>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>kernel_size</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>An integer or tuple/list of 2 integers, specifying the
height and width of the 2D convolution window.
Can be a single integer to specify the same value for
all spatial dimensions.</p>
            </div>
            <p>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>strides</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>An integer or tuple/list of 2 integers,
specifying the strides of the convolution along the height and width.
Can be a single integer to specify the same value for
all spatial dimensions.
Specifying any stride value != 1 is incompatible with specifying
any <code>dilation_rate</code> value != 1.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>(1, 1)</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>padding</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>one of <code>"valid"</code> or <code>"same"</code> (case-insensitive).</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>&#39;same&#39;</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>data_format</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>A string,
one of <code>channels_last</code> (default) or <code>channels_first</code>.
The ordering of the dimensions in the inputs.
<code>channels_last</code> corresponds to inputs with shape
<code>(batch, height, width, channels)</code> while <code>channels_first</code>
corresponds to inputs with shape
<code>(batch, channels, height, width)</code>.
It defaults to the <code>image_data_format</code> value found in your
Keras config file at <code>~/.keras/keras.json</code>.
If you never set it, then it will be "channels_last".</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>dilation_rate</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>an integer or tuple/list of 2 integers, specifying
the dilation rate to use for dilated convolution.
Can be a single integer to specify the same value for
all spatial dimensions.
Currently, specifying any <code>dilation_rate</code> value != 1 is
incompatible with specifying any stride value != 1.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>(1, 1)</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>activation</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Activation function to use.
If you don't specify anything, no activation is applied
(ie. "linear" activation: <code>a(x) = x</code>).</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>use_bias</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Boolean, whether the layer uses a bias vector.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>True</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>kernel_initializer</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Initializer for the <code>kernel</code> weights matrix.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code><a class="autorefs autorefs-internal" title="deel.lip.initializers.SpectralInitializer" href="../initializers/#deel.lip.initializers.SpectralInitializer">SpectralInitializer</a>()</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>bias_initializer</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Initializer for the bias vector.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>&#39;zeros&#39;</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>kernel_regularizer</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Regularizer function applied to
the <code>kernel</code> weights matrix.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>bias_regularizer</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Regularizer function applied to the bias vector.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>activity_regularizer</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Regularizer function applied to
the output of the layer (its "activation")..</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>kernel_constraint</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Constraint function applied to the kernel matrix.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>bias_constraint</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Constraint function applied to the bias vector.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>k_coef_lip</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>lipschitz constant to ensure</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>1.0</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>eps_spectral</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>stopping criterion for the iterative power algorithm.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code><span title="deel.lip.normalizers.DEFAULT_EPS_SPECTRAL">DEFAULT_EPS_SPECTRAL</span></code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>eps_bjorck</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>stopping criterion Bjorck algorithm.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code><span title="deel.lip.normalizers.DEFAULT_EPS_BJORCK">DEFAULT_EPS_BJORCK</span></code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>beta_bjorck</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>beta parameter in bjorck algorithm.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code><span title="deel.lip.normalizers.DEFAULT_BETA_BJORCK">DEFAULT_BETA_BJORCK</span></code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>maxiter_spectral</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>maximum number of iterations for the power iteration.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code><span title="deel.lip.normalizers.DEFAULT_MAXITER_SPECTRAL">DEFAULT_MAXITER_SPECTRAL</span></code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>maxiter_bjorck</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>maximum number of iterations for bjorck algorithm.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code><span title="deel.lip.normalizers.DEFAULT_MAXITER_BJORCK">DEFAULT_MAXITER_BJORCK</span></code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>
      <p>This documentation reuse the body of the original keras.layers.Conv2D doc.</p>

                <details class="quote">
                  <summary>Source code in <code>deel/lip/layers/convolutional.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">filters</span><span class="p">,</span>
    <span class="n">kernel_size</span><span class="p">,</span>
    <span class="n">strides</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">padding</span><span class="o">=</span><span class="s2">&quot;same&quot;</span><span class="p">,</span>
    <span class="n">data_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">dilation_rate</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">activation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="o">=</span><span class="n">SpectralInitializer</span><span class="p">(),</span>
    <span class="n">bias_initializer</span><span class="o">=</span><span class="s2">&quot;zeros&quot;</span><span class="p">,</span>
    <span class="n">kernel_regularizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">bias_regularizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">activity_regularizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">kernel_constraint</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">bias_constraint</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">k_coef_lip</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">eps_spectral</span><span class="o">=</span><span class="n">DEFAULT_EPS_SPECTRAL</span><span class="p">,</span>
    <span class="n">eps_bjorck</span><span class="o">=</span><span class="n">DEFAULT_EPS_BJORCK</span><span class="p">,</span>
    <span class="n">beta_bjorck</span><span class="o">=</span><span class="n">DEFAULT_BETA_BJORCK</span><span class="p">,</span>
    <span class="n">maxiter_spectral</span><span class="o">=</span><span class="n">DEFAULT_MAXITER_SPECTRAL</span><span class="p">,</span>
    <span class="n">maxiter_bjorck</span><span class="o">=</span><span class="n">DEFAULT_MAXITER_BJORCK</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class is a Conv2D Layer constrained such that all singular of it&#39;s kernel</span>
<span class="sd">    are 1. The computation based on Bjorck algorithm. As this is not</span>
<span class="sd">    enough to ensure 1 Lipschitzity a coertive coefficient is applied on the</span>
<span class="sd">    output.</span>
<span class="sd">    The computation is done in three steps:</span>

<span class="sd">    1. reduce the largest singular value to 1, using iterated power method.</span>
<span class="sd">    2. increase other singular values to 1, using Bjorck algorithm.</span>
<span class="sd">    3. divide the output by the Lipschitz bound to ensure k Lipschitzity.</span>

<span class="sd">    Args:</span>
<span class="sd">        filters: Integer, the dimensionality of the output space</span>
<span class="sd">            (i.e. the number of output filters in the convolution).</span>
<span class="sd">        kernel_size: An integer or tuple/list of 2 integers, specifying the</span>
<span class="sd">            height and width of the 2D convolution window.</span>
<span class="sd">            Can be a single integer to specify the same value for</span>
<span class="sd">            all spatial dimensions.</span>
<span class="sd">        strides: An integer or tuple/list of 2 integers,</span>
<span class="sd">            specifying the strides of the convolution along the height and width.</span>
<span class="sd">            Can be a single integer to specify the same value for</span>
<span class="sd">            all spatial dimensions.</span>
<span class="sd">            Specifying any stride value != 1 is incompatible with specifying</span>
<span class="sd">            any `dilation_rate` value != 1.</span>
<span class="sd">        padding: one of `&quot;valid&quot;` or `&quot;same&quot;` (case-insensitive).</span>
<span class="sd">        data_format: A string,</span>
<span class="sd">            one of `channels_last` (default) or `channels_first`.</span>
<span class="sd">            The ordering of the dimensions in the inputs.</span>
<span class="sd">            `channels_last` corresponds to inputs with shape</span>
<span class="sd">            `(batch, height, width, channels)` while `channels_first`</span>
<span class="sd">            corresponds to inputs with shape</span>
<span class="sd">            `(batch, channels, height, width)`.</span>
<span class="sd">            It defaults to the `image_data_format` value found in your</span>
<span class="sd">            Keras config file at `~/.keras/keras.json`.</span>
<span class="sd">            If you never set it, then it will be &quot;channels_last&quot;.</span>
<span class="sd">        dilation_rate: an integer or tuple/list of 2 integers, specifying</span>
<span class="sd">            the dilation rate to use for dilated convolution.</span>
<span class="sd">            Can be a single integer to specify the same value for</span>
<span class="sd">            all spatial dimensions.</span>
<span class="sd">            Currently, specifying any `dilation_rate` value != 1 is</span>
<span class="sd">            incompatible with specifying any stride value != 1.</span>
<span class="sd">        activation: Activation function to use.</span>
<span class="sd">            If you don&#39;t specify anything, no activation is applied</span>
<span class="sd">            (ie. &quot;linear&quot; activation: `a(x) = x`).</span>
<span class="sd">        use_bias: Boolean, whether the layer uses a bias vector.</span>
<span class="sd">        kernel_initializer: Initializer for the `kernel` weights matrix.</span>
<span class="sd">        bias_initializer: Initializer for the bias vector.</span>
<span class="sd">        kernel_regularizer: Regularizer function applied to</span>
<span class="sd">            the `kernel` weights matrix.</span>
<span class="sd">        bias_regularizer: Regularizer function applied to the bias vector.</span>
<span class="sd">        activity_regularizer: Regularizer function applied to</span>
<span class="sd">            the output of the layer (its &quot;activation&quot;)..</span>
<span class="sd">        kernel_constraint: Constraint function applied to the kernel matrix.</span>
<span class="sd">        bias_constraint: Constraint function applied to the bias vector.</span>
<span class="sd">        k_coef_lip: lipschitz constant to ensure</span>
<span class="sd">        eps_spectral: stopping criterion for the iterative power algorithm.</span>
<span class="sd">        eps_bjorck: stopping criterion Bjorck algorithm.</span>
<span class="sd">        beta_bjorck: beta parameter in bjorck algorithm.</span>
<span class="sd">        maxiter_spectral: maximum number of iterations for the power iteration.</span>
<span class="sd">        maxiter_bjorck: maximum number of iterations for bjorck algorithm.</span>

<span class="sd">    This documentation reuse the body of the original keras.layers.Conv2D doc.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">dilation_rate</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;SpectralConv2D does not support dilation rate&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">padding</span> <span class="o">!=</span> <span class="s2">&quot;same&quot;</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;SpectralConv2D only supports padding=&#39;same&#39;&quot;</span><span class="p">)</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">SpectralConv2D</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">,</span>
        <span class="n">kernel_size</span><span class="o">=</span><span class="n">kernel_size</span><span class="p">,</span>
        <span class="n">strides</span><span class="o">=</span><span class="n">strides</span><span class="p">,</span>
        <span class="n">padding</span><span class="o">=</span><span class="n">padding</span><span class="p">,</span>
        <span class="n">data_format</span><span class="o">=</span><span class="n">data_format</span><span class="p">,</span>
        <span class="n">dilation_rate</span><span class="o">=</span><span class="n">dilation_rate</span><span class="p">,</span>
        <span class="n">activation</span><span class="o">=</span><span class="n">activation</span><span class="p">,</span>
        <span class="n">use_bias</span><span class="o">=</span><span class="n">use_bias</span><span class="p">,</span>
        <span class="n">kernel_initializer</span><span class="o">=</span><span class="n">kernel_initializer</span><span class="p">,</span>
        <span class="n">bias_initializer</span><span class="o">=</span><span class="n">bias_initializer</span><span class="p">,</span>
        <span class="n">kernel_regularizer</span><span class="o">=</span><span class="n">kernel_regularizer</span><span class="p">,</span>
        <span class="n">bias_regularizer</span><span class="o">=</span><span class="n">bias_regularizer</span><span class="p">,</span>
        <span class="n">activity_regularizer</span><span class="o">=</span><span class="n">activity_regularizer</span><span class="p">,</span>
        <span class="n">kernel_constraint</span><span class="o">=</span><span class="n">kernel_constraint</span><span class="p">,</span>
        <span class="n">bias_constraint</span><span class="o">=</span><span class="n">bias_constraint</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">set_klip_factor</span><span class="p">(</span><span class="n">k_coef_lip</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">u</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sig</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">wbar</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_check_RKO_params</span><span class="p">(</span><span class="n">eps_spectral</span><span class="p">,</span> <span class="n">eps_bjorck</span><span class="p">,</span> <span class="n">beta_bjorck</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">eps_spectral</span> <span class="o">=</span> <span class="n">eps_spectral</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">eps_bjorck</span> <span class="o">=</span> <span class="n">eps_bjorck</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">beta_bjorck</span> <span class="o">=</span> <span class="n">beta_bjorck</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">maxiter_bjorck</span> <span class="o">=</span> <span class="n">maxiter_bjorck</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">maxiter_spectral</span> <span class="o">=</span> <span class="n">maxiter_spectral</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h3 id="deel.lip.layers.convolutional.SpectralConv2DTranspose" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">SpectralConv2DTranspose</span>


<a href="#deel.lip.layers.convolutional.SpectralConv2DTranspose" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">SpectralConv2DTranspose</span><span class="p">(</span>
    <span class="n">filters</span><span class="p">,</span>
    <span class="n">kernel_size</span><span class="p">,</span>
    <span class="n">strides</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">padding</span><span class="o">=</span><span class="s2">&quot;same&quot;</span><span class="p">,</span>
    <span class="n">output_padding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">data_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">dilation_rate</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">activation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="o">=</span><span class="n">SpectralInitializer</span><span class="p">(),</span>
    <span class="n">bias_initializer</span><span class="o">=</span><span class="s2">&quot;zeros&quot;</span><span class="p">,</span>
    <span class="n">kernel_regularizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">bias_regularizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">activity_regularizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">kernel_constraint</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">bias_constraint</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">k_coef_lip</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">eps_spectral</span><span class="o">=</span><span class="n">DEFAULT_EPS_SPECTRAL</span><span class="p">,</span>
    <span class="n">eps_bjorck</span><span class="o">=</span><span class="n">DEFAULT_EPS_BJORCK</span><span class="p">,</span>
    <span class="n">beta_bjorck</span><span class="o">=</span><span class="n">DEFAULT_BETA_BJORCK</span><span class="p">,</span>
    <span class="n">maxiter_spectral</span><span class="o">=</span><span class="n">DEFAULT_MAXITER_SPECTRAL</span><span class="p">,</span>
    <span class="n">maxiter_bjorck</span><span class="o">=</span><span class="n">DEFAULT_MAXITER_BJORCK</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="tensorflow.keras.layers.Conv2DTranspose">Conv2DTranspose</span></code>, <code><a class="autorefs autorefs-internal" title="deel.lip.layers.base_layer.LipschitzLayer" href="#deel.lip.layers.base_layer.LipschitzLayer">LipschitzLayer</a></code>, <code><a class="autorefs autorefs-internal" title="deel.lip.layers.base_layer.Condensable" href="#deel.lip.layers.base_layer.Condensable">Condensable</a></code></p>

  
      <p>This class is a Conv2DTranspose layer constrained such that all singular values
of its kernel are 1. The computation is based on Björck orthogonalization
algorithm.</p>
<p>The computation is done in three steps:
1. reduce the largest singular value to 1, using iterated power method.
2. increase other singular values to 1, using Björck algorithm.
3. divide the output by the Lipschitz target K to ensure K-Lipschitzity.</p>
<p>This documentation reuses the body of the original
<code>tf.keras.layers.Conv2DTranspose</code> doc.</p>



  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b> DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>filters</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Integer, the dimensionality of the output space
(i.e. the number of output filters in the convolution).</p>
            </div>
            <p>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>kernel_size</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>An integer or tuple/list of 2 integers, specifying the
height and width of the 2D convolution window.
Can be a single integer to specify the same value for
all spatial dimensions.</p>
            </div>
            <p>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>strides</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>An integer or tuple/list of 2 integers,
specifying the strides of the convolution along the height and width.
Can be a single integer to specify the same value for
all spatial dimensions.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>(1, 1)</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>padding</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>only <code>"same"</code> padding is supported in this Lipschitz layer
(case-insensitive).</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>&#39;same&#39;</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>output_padding</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>if set to <code>None</code> (default), the output shape is inferred.
Only <code>None</code> value is supported in this Lipschitz layer.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>data_format</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>A string,
one of <code>channels_last</code> (default) or <code>channels_first</code>.
The ordering of the dimensions in the inputs.
<code>channels_last</code> corresponds to inputs with shape
<code>(batch, height, width, channels)</code> while <code>channels_first</code>
corresponds to inputs with shape
<code>(batch, channels, height, width)</code>.
It defaults to the <code>image_data_format</code> value found in your
Keras config file at <code>~/.keras/keras.json</code>.
If you never set it, then it will be "channels_last".</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>dilation_rate</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>an integer, specifying the dilation rate for all spatial
dimensions for dilated convolution. This Lipschitz layer does not
support dilation rate != 1.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>(1, 1)</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>activation</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Activation function to use.
If you don't specify anything, no activation is applied
(see <code>keras.activations</code>).</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>use_bias</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Boolean, whether the layer uses a bias vector.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>True</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>kernel_initializer</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Initializer for the <code>kernel</code> weights matrix
(see <code>keras.initializers</code>). Defaults to <code>SpectralInitializer</code>.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code><a class="autorefs autorefs-internal" title="deel.lip.initializers.SpectralInitializer" href="../initializers/#deel.lip.initializers.SpectralInitializer">SpectralInitializer</a>()</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>bias_initializer</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Initializer for the bias vector
(see <code>keras.initializers</code>). Defaults to 'zeros'.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>&#39;zeros&#39;</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>kernel_regularizer</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Regularizer function applied to
the <code>kernel</code> weights matrix (see <code>keras.regularizers</code>).</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>bias_regularizer</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Regularizer function applied to the bias vector
(see <code>keras.regularizers</code>).</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>activity_regularizer</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Regularizer function applied to
the output of the layer (its "activation") (see <code>keras.regularizers</code>).</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>kernel_constraint</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Constraint function applied to the kernel matrix
(see <code>keras.constraints</code>).</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>bias_constraint</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Constraint function applied to the bias vector
(see <code>keras.constraints</code>).</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>k_coef_lip</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Lipschitz constant to ensure</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>1.0</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>eps_spectral</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>stopping criterion for the iterative power algorithm.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code><span title="deel.lip.normalizers.DEFAULT_EPS_SPECTRAL">DEFAULT_EPS_SPECTRAL</span></code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>eps_bjorck</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>stopping criterion Björck algorithm.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code><span title="deel.lip.normalizers.DEFAULT_EPS_BJORCK">DEFAULT_EPS_BJORCK</span></code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>beta_bjorck</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>beta parameter in Björck algorithm.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code><span title="deel.lip.normalizers.DEFAULT_BETA_BJORCK">DEFAULT_BETA_BJORCK</span></code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>maxiter_spectral</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>maximum number of iterations for the power iteration.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code><span title="deel.lip.normalizers.DEFAULT_MAXITER_SPECTRAL">DEFAULT_MAXITER_SPECTRAL</span></code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>maxiter_bjorck</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>maximum number of iterations for bjorck algorithm.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code><span title="deel.lip.normalizers.DEFAULT_MAXITER_BJORCK">DEFAULT_MAXITER_BJORCK</span></code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

                <details class="quote">
                  <summary>Source code in <code>deel/lip/layers/convolutional.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">filters</span><span class="p">,</span>
    <span class="n">kernel_size</span><span class="p">,</span>
    <span class="n">strides</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">padding</span><span class="o">=</span><span class="s2">&quot;same&quot;</span><span class="p">,</span>
    <span class="n">output_padding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">data_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">dilation_rate</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">activation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="o">=</span><span class="n">SpectralInitializer</span><span class="p">(),</span>
    <span class="n">bias_initializer</span><span class="o">=</span><span class="s2">&quot;zeros&quot;</span><span class="p">,</span>
    <span class="n">kernel_regularizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">bias_regularizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">activity_regularizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">kernel_constraint</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">bias_constraint</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">k_coef_lip</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">eps_spectral</span><span class="o">=</span><span class="n">DEFAULT_EPS_SPECTRAL</span><span class="p">,</span>
    <span class="n">eps_bjorck</span><span class="o">=</span><span class="n">DEFAULT_EPS_BJORCK</span><span class="p">,</span>
    <span class="n">beta_bjorck</span><span class="o">=</span><span class="n">DEFAULT_BETA_BJORCK</span><span class="p">,</span>
    <span class="n">maxiter_spectral</span><span class="o">=</span><span class="n">DEFAULT_MAXITER_SPECTRAL</span><span class="p">,</span>
    <span class="n">maxiter_bjorck</span><span class="o">=</span><span class="n">DEFAULT_MAXITER_BJORCK</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class is a Conv2DTranspose layer constrained such that all singular values</span>
<span class="sd">    of its kernel are 1. The computation is based on Björck orthogonalization</span>
<span class="sd">    algorithm.</span>

<span class="sd">    The computation is done in three steps:</span>
<span class="sd">    1. reduce the largest singular value to 1, using iterated power method.</span>
<span class="sd">    2. increase other singular values to 1, using Björck algorithm.</span>
<span class="sd">    3. divide the output by the Lipschitz target K to ensure K-Lipschitzity.</span>

<span class="sd">    This documentation reuses the body of the original</span>
<span class="sd">    `tf.keras.layers.Conv2DTranspose` doc.</span>

<span class="sd">    Args:</span>
<span class="sd">        filters: Integer, the dimensionality of the output space</span>
<span class="sd">            (i.e. the number of output filters in the convolution).</span>
<span class="sd">        kernel_size: An integer or tuple/list of 2 integers, specifying the</span>
<span class="sd">            height and width of the 2D convolution window.</span>
<span class="sd">            Can be a single integer to specify the same value for</span>
<span class="sd">            all spatial dimensions.</span>
<span class="sd">        strides: An integer or tuple/list of 2 integers,</span>
<span class="sd">            specifying the strides of the convolution along the height and width.</span>
<span class="sd">            Can be a single integer to specify the same value for</span>
<span class="sd">            all spatial dimensions.</span>
<span class="sd">        padding: only `&quot;same&quot;` padding is supported in this Lipschitz layer</span>
<span class="sd">            (case-insensitive).</span>
<span class="sd">        output_padding: if set to `None` (default), the output shape is inferred.</span>
<span class="sd">            Only `None` value is supported in this Lipschitz layer.</span>
<span class="sd">        data_format: A string,</span>
<span class="sd">            one of `channels_last` (default) or `channels_first`.</span>
<span class="sd">            The ordering of the dimensions in the inputs.</span>
<span class="sd">            `channels_last` corresponds to inputs with shape</span>
<span class="sd">            `(batch, height, width, channels)` while `channels_first`</span>
<span class="sd">            corresponds to inputs with shape</span>
<span class="sd">            `(batch, channels, height, width)`.</span>
<span class="sd">            It defaults to the `image_data_format` value found in your</span>
<span class="sd">            Keras config file at `~/.keras/keras.json`.</span>
<span class="sd">            If you never set it, then it will be &quot;channels_last&quot;.</span>
<span class="sd">        dilation_rate: an integer, specifying the dilation rate for all spatial</span>
<span class="sd">            dimensions for dilated convolution. This Lipschitz layer does not</span>
<span class="sd">            support dilation rate != 1.</span>
<span class="sd">        activation: Activation function to use.</span>
<span class="sd">            If you don&#39;t specify anything, no activation is applied</span>
<span class="sd">            (see `keras.activations`).</span>
<span class="sd">        use_bias: Boolean, whether the layer uses a bias vector.</span>
<span class="sd">        kernel_initializer: Initializer for the `kernel` weights matrix</span>
<span class="sd">            (see `keras.initializers`). Defaults to `SpectralInitializer`.</span>
<span class="sd">        bias_initializer: Initializer for the bias vector</span>
<span class="sd">            (see `keras.initializers`). Defaults to &#39;zeros&#39;.</span>
<span class="sd">        kernel_regularizer: Regularizer function applied to</span>
<span class="sd">            the `kernel` weights matrix (see `keras.regularizers`).</span>
<span class="sd">        bias_regularizer: Regularizer function applied to the bias vector</span>
<span class="sd">            (see `keras.regularizers`).</span>
<span class="sd">        activity_regularizer: Regularizer function applied to</span>
<span class="sd">            the output of the layer (its &quot;activation&quot;) (see `keras.regularizers`).</span>
<span class="sd">        kernel_constraint: Constraint function applied to the kernel matrix</span>
<span class="sd">            (see `keras.constraints`).</span>
<span class="sd">        bias_constraint: Constraint function applied to the bias vector</span>
<span class="sd">            (see `keras.constraints`).</span>
<span class="sd">        k_coef_lip: Lipschitz constant to ensure</span>
<span class="sd">        eps_spectral: stopping criterion for the iterative power algorithm.</span>
<span class="sd">        eps_bjorck: stopping criterion Björck algorithm.</span>
<span class="sd">        beta_bjorck: beta parameter in Björck algorithm.</span>
<span class="sd">        maxiter_spectral: maximum number of iterations for the power iteration.</span>
<span class="sd">        maxiter_bjorck: maximum number of iterations for bjorck algorithm.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">filters</span><span class="p">,</span>
        <span class="n">kernel_size</span><span class="p">,</span>
        <span class="n">strides</span><span class="p">,</span>
        <span class="n">padding</span><span class="p">,</span>
        <span class="n">output_padding</span><span class="p">,</span>
        <span class="n">data_format</span><span class="p">,</span>
        <span class="n">dilation_rate</span><span class="p">,</span>
        <span class="n">activation</span><span class="p">,</span>
        <span class="n">use_bias</span><span class="p">,</span>
        <span class="n">kernel_initializer</span><span class="p">,</span>
        <span class="n">bias_initializer</span><span class="p">,</span>
        <span class="n">kernel_regularizer</span><span class="p">,</span>
        <span class="n">bias_regularizer</span><span class="p">,</span>
        <span class="n">activity_regularizer</span><span class="p">,</span>
        <span class="n">kernel_constraint</span><span class="p">,</span>
        <span class="n">bias_constraint</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dilation_rate</span> <span class="o">!=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;SpectralConv2DTranspose does not support dilation rate&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">padding</span> <span class="o">!=</span> <span class="s2">&quot;same&quot;</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;SpectralConv2DTranspose only supports padding=&#39;same&#39;&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_padding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;SpectralConv2DTranspose only supports output_padding=None&quot;</span>
        <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">set_klip_factor</span><span class="p">(</span><span class="n">k_coef_lip</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">u</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sig</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">wbar</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_check_RKO_params</span><span class="p">(</span><span class="n">eps_spectral</span><span class="p">,</span> <span class="n">eps_bjorck</span><span class="p">,</span> <span class="n">beta_bjorck</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">eps_spectral</span> <span class="o">=</span> <span class="n">eps_spectral</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">eps_bjorck</span> <span class="o">=</span> <span class="n">eps_bjorck</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">beta_bjorck</span> <span class="o">=</span> <span class="n">beta_bjorck</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">maxiter_bjorck</span> <span class="o">=</span> <span class="n">maxiter_bjorck</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">maxiter_spectral</span> <span class="o">=</span> <span class="n">maxiter_spectral</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>




  </div>

  </div>

</div>

<div class="doc doc-object doc-module">




<h2 id="deel.lip.layers.dense" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">dense</span>


<a href="#deel.lip.layers.dense" class="headerlink" title="Permanent link">&para;</a></h2>

  <div class="doc doc-contents ">
  
      <p>This module extends original keras layers, in order to add k lipschitz constraint via
reparametrization. Currently, are implemented:
* Dense layer:
    as SpectralDense (and as FrobeniusDense when the layer has a single
    output)
* Conv2D layer:
    as SpectralConv2D (and as FrobeniusConv2D when the layer has a single
    output)
* AveragePooling:
    as ScaledAveragePooling
* GlobalAveragePooling2D:
    as ScaledGlobalAveragePooling2D
By default the layers are 1 Lipschitz almost everywhere, which is efficient for
wasserstein distance estimation. However for other problems (such as adversarial
robustness) the user may want to use layers that are at most 1 lipschitz, this can
be done by setting the param <code>eps_bjorck=None</code>.</p>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">




<h3 id="deel.lip.layers.dense.FrobeniusDense" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">FrobeniusDense</span>


<a href="#deel.lip.layers.dense.FrobeniusDense" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">FrobeniusDense</span><span class="p">(</span>
    <span class="n">units</span><span class="p">,</span>
    <span class="n">activation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="o">=</span><span class="n">SpectralInitializer</span><span class="p">(),</span>
    <span class="n">bias_initializer</span><span class="o">=</span><span class="s2">&quot;zeros&quot;</span><span class="p">,</span>
    <span class="n">kernel_regularizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">bias_regularizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">activity_regularizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">kernel_constraint</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">bias_constraint</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">disjoint_neurons</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">k_coef_lip</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="tensorflow.keras.layers.Dense">Dense</span></code>, <code><a class="autorefs autorefs-internal" title="deel.lip.layers.base_layer.LipschitzLayer" href="#deel.lip.layers.base_layer.LipschitzLayer">LipschitzLayer</a></code>, <code><a class="autorefs autorefs-internal" title="deel.lip.layers.base_layer.Condensable" href="#deel.lip.layers.base_layer.Condensable">Condensable</a></code></p>

  
      <p>Identical and faster than a SpectralDense in the case of a single output. In the
multi-neurons setting, this layer can be used:
- as a classical Frobenius Dense normalization (disjoint_neurons=False)
- as a stacking of 1 lipschitz independent neurons (each output is 1-lipschitz,
but the no orthogonality is enforced between outputs )  (disjoint_neurons=True).</p>

<details class="warning-" open>
  <summary>Warning</summary>
  <p>default is disjoint_neurons = True</p>
</details>
                <details class="quote">
                  <summary>Source code in <code>deel/lip/layers/dense.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">units</span><span class="p">,</span>
    <span class="n">activation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="o">=</span><span class="n">SpectralInitializer</span><span class="p">(),</span>
    <span class="n">bias_initializer</span><span class="o">=</span><span class="s2">&quot;zeros&quot;</span><span class="p">,</span>
    <span class="n">kernel_regularizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">bias_regularizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">activity_regularizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">kernel_constraint</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">bias_constraint</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">disjoint_neurons</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">k_coef_lip</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">):</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span>
        <span class="n">activation</span><span class="o">=</span><span class="n">activation</span><span class="p">,</span>
        <span class="n">use_bias</span><span class="o">=</span><span class="n">use_bias</span><span class="p">,</span>
        <span class="n">kernel_initializer</span><span class="o">=</span><span class="n">kernel_initializer</span><span class="p">,</span>
        <span class="n">bias_initializer</span><span class="o">=</span><span class="n">bias_initializer</span><span class="p">,</span>
        <span class="n">kernel_regularizer</span><span class="o">=</span><span class="n">kernel_regularizer</span><span class="p">,</span>
        <span class="n">bias_regularizer</span><span class="o">=</span><span class="n">bias_regularizer</span><span class="p">,</span>
        <span class="n">activity_regularizer</span><span class="o">=</span><span class="n">activity_regularizer</span><span class="p">,</span>
        <span class="n">kernel_constraint</span><span class="o">=</span><span class="n">kernel_constraint</span><span class="p">,</span>
        <span class="n">bias_constraint</span><span class="o">=</span><span class="n">bias_constraint</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">set_klip_factor</span><span class="p">(</span><span class="n">k_coef_lip</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">disjoint_neurons</span> <span class="o">=</span> <span class="n">disjoint_neurons</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">axis_norm</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">wbar</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">disjoint_neurons</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axis_norm</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h3 id="deel.lip.layers.dense.SpectralDense" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">SpectralDense</span>


<a href="#deel.lip.layers.dense.SpectralDense" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">SpectralDense</span><span class="p">(</span>
    <span class="n">units</span><span class="p">,</span>
    <span class="n">activation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="o">=</span><span class="n">SpectralInitializer</span><span class="p">(),</span>
    <span class="n">bias_initializer</span><span class="o">=</span><span class="s2">&quot;zeros&quot;</span><span class="p">,</span>
    <span class="n">kernel_regularizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">bias_regularizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">activity_regularizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">kernel_constraint</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">bias_constraint</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">k_coef_lip</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">eps_spectral</span><span class="o">=</span><span class="n">DEFAULT_EPS_SPECTRAL</span><span class="p">,</span>
    <span class="n">eps_bjorck</span><span class="o">=</span><span class="n">DEFAULT_EPS_BJORCK</span><span class="p">,</span>
    <span class="n">beta_bjorck</span><span class="o">=</span><span class="n">DEFAULT_BETA_BJORCK</span><span class="p">,</span>
    <span class="n">maxiter_spectral</span><span class="o">=</span><span class="n">DEFAULT_MAXITER_SPECTRAL</span><span class="p">,</span>
    <span class="n">maxiter_bjorck</span><span class="o">=</span><span class="n">DEFAULT_MAXITER_BJORCK</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="tensorflow.keras.layers.Dense">Dense</span></code>, <code><a class="autorefs autorefs-internal" title="deel.lip.layers.base_layer.LipschitzLayer" href="#deel.lip.layers.base_layer.LipschitzLayer">LipschitzLayer</a></code>, <code><a class="autorefs autorefs-internal" title="deel.lip.layers.base_layer.Condensable" href="#deel.lip.layers.base_layer.Condensable">Condensable</a></code></p>

  
      <p>This class is a Dense Layer constrained such that all singular of it's kernel
are 1. The computation based on Bjorck algorithm.
The computation is done in two steps:</p>
<ol>
<li>reduce the larget singular value to 1, using iterated power method.</li>
<li>increase other singular values to 1, using Bjorck algorithm.</li>
</ol>



  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b> DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>units</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Positive integer, dimensionality of the output space.</p>
            </div>
            <p>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>activation</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Activation function to use.
If you don't specify anything, no activation is applied
(ie. "linear" activation: <code>a(x) = x</code>).</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>use_bias</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Boolean, whether the layer uses a bias vector.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>True</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>kernel_initializer</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Initializer for the <code>kernel</code> weights matrix.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code><a class="autorefs autorefs-internal" title="deel.lip.initializers.SpectralInitializer" href="../initializers/#deel.lip.initializers.SpectralInitializer">SpectralInitializer</a>()</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>bias_initializer</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Initializer for the bias vector.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>&#39;zeros&#39;</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>kernel_regularizer</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Regularizer function applied to
the <code>kernel</code> weights matrix.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>bias_regularizer</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Regularizer function applied to the bias vector.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>activity_regularizer</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Regularizer function applied to
the output of the layer (its "activation")..</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>kernel_constraint</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Constraint function applied to
the <code>kernel</code> weights matrix.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>bias_constraint</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Constraint function applied to the bias vector.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>k_coef_lip</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>lipschitz constant to ensure</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>1.0</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>eps_spectral</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>stopping criterion for the iterative power algorithm.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code><span title="deel.lip.normalizers.DEFAULT_EPS_SPECTRAL">DEFAULT_EPS_SPECTRAL</span></code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>eps_bjorck</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>stopping criterion Bjorck algorithm.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code><span title="deel.lip.normalizers.DEFAULT_EPS_BJORCK">DEFAULT_EPS_BJORCK</span></code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>beta_bjorck</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>beta parameter in bjorck algorithm.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code><span title="deel.lip.normalizers.DEFAULT_BETA_BJORCK">DEFAULT_BETA_BJORCK</span></code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>maxiter_spectral</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>maximum number of iterations for the power iteration.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code><span title="deel.lip.normalizers.DEFAULT_MAXITER_SPECTRAL">DEFAULT_MAXITER_SPECTRAL</span></code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>maxiter_bjorck</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>maximum number of iterations for bjorck algorithm.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code><span title="deel.lip.normalizers.DEFAULT_MAXITER_BJORCK">DEFAULT_MAXITER_BJORCK</span></code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

<details class="input-shape" open>
  <summary>Input shape</summary>
  <p>N-D tensor with shape: <code>(batch_size, ..., input_dim)</code>.
The most common situation would be
a 2D input with shape <code>(batch_size, input_dim)</code>.</p>
</details>
<details class="output-shape" open>
  <summary>Output shape</summary>
  <p>N-D tensor with shape: <code>(batch_size, ..., units)</code>.
For instance, for a 2D input with shape <code>(batch_size, input_dim)</code>,
the output would have shape <code>(batch_size, units)</code>.</p>
</details>      <p>This documentation reuse the body of the original keras.layers.Dense doc.</p>

                <details class="quote">
                  <summary>Source code in <code>deel/lip/layers/dense.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">units</span><span class="p">,</span>
    <span class="n">activation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="o">=</span><span class="n">SpectralInitializer</span><span class="p">(),</span>
    <span class="n">bias_initializer</span><span class="o">=</span><span class="s2">&quot;zeros&quot;</span><span class="p">,</span>
    <span class="n">kernel_regularizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">bias_regularizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">activity_regularizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">kernel_constraint</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">bias_constraint</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">k_coef_lip</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">eps_spectral</span><span class="o">=</span><span class="n">DEFAULT_EPS_SPECTRAL</span><span class="p">,</span>
    <span class="n">eps_bjorck</span><span class="o">=</span><span class="n">DEFAULT_EPS_BJORCK</span><span class="p">,</span>
    <span class="n">beta_bjorck</span><span class="o">=</span><span class="n">DEFAULT_BETA_BJORCK</span><span class="p">,</span>
    <span class="n">maxiter_spectral</span><span class="o">=</span><span class="n">DEFAULT_MAXITER_SPECTRAL</span><span class="p">,</span>
    <span class="n">maxiter_bjorck</span><span class="o">=</span><span class="n">DEFAULT_MAXITER_BJORCK</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class is a Dense Layer constrained such that all singular of it&#39;s kernel</span>
<span class="sd">    are 1. The computation based on Bjorck algorithm.</span>
<span class="sd">    The computation is done in two steps:</span>

<span class="sd">    1. reduce the larget singular value to 1, using iterated power method.</span>
<span class="sd">    2. increase other singular values to 1, using Bjorck algorithm.</span>

<span class="sd">    Args:</span>
<span class="sd">        units: Positive integer, dimensionality of the output space.</span>
<span class="sd">        activation: Activation function to use.</span>
<span class="sd">            If you don&#39;t specify anything, no activation is applied</span>
<span class="sd">            (ie. &quot;linear&quot; activation: `a(x) = x`).</span>
<span class="sd">        use_bias: Boolean, whether the layer uses a bias vector.</span>
<span class="sd">        kernel_initializer: Initializer for the `kernel` weights matrix.</span>
<span class="sd">        bias_initializer: Initializer for the bias vector.</span>
<span class="sd">        kernel_regularizer: Regularizer function applied to</span>
<span class="sd">            the `kernel` weights matrix.</span>
<span class="sd">        bias_regularizer: Regularizer function applied to the bias vector.</span>
<span class="sd">        activity_regularizer: Regularizer function applied to</span>
<span class="sd">            the output of the layer (its &quot;activation&quot;)..</span>
<span class="sd">        kernel_constraint: Constraint function applied to</span>
<span class="sd">            the `kernel` weights matrix.</span>
<span class="sd">        bias_constraint: Constraint function applied to the bias vector.</span>
<span class="sd">        k_coef_lip: lipschitz constant to ensure</span>
<span class="sd">        eps_spectral: stopping criterion for the iterative power algorithm.</span>
<span class="sd">        eps_bjorck: stopping criterion Bjorck algorithm.</span>
<span class="sd">        beta_bjorck: beta parameter in bjorck algorithm.</span>
<span class="sd">        maxiter_spectral: maximum number of iterations for the power iteration.</span>
<span class="sd">        maxiter_bjorck: maximum number of iterations for bjorck algorithm.</span>

<span class="sd">    Input shape:</span>
<span class="sd">        N-D tensor with shape: `(batch_size, ..., input_dim)`.</span>
<span class="sd">        The most common situation would be</span>
<span class="sd">        a 2D input with shape `(batch_size, input_dim)`.</span>

<span class="sd">    Output shape:</span>
<span class="sd">        N-D tensor with shape: `(batch_size, ..., units)`.</span>
<span class="sd">        For instance, for a 2D input with shape `(batch_size, input_dim)`,</span>
<span class="sd">        the output would have shape `(batch_size, units)`.</span>

<span class="sd">    This documentation reuse the body of the original keras.layers.Dense doc.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">SpectralDense</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span>
        <span class="n">activation</span><span class="o">=</span><span class="n">activation</span><span class="p">,</span>
        <span class="n">use_bias</span><span class="o">=</span><span class="n">use_bias</span><span class="p">,</span>
        <span class="n">kernel_initializer</span><span class="o">=</span><span class="n">kernel_initializer</span><span class="p">,</span>
        <span class="n">bias_initializer</span><span class="o">=</span><span class="n">bias_initializer</span><span class="p">,</span>
        <span class="n">kernel_regularizer</span><span class="o">=</span><span class="n">kernel_regularizer</span><span class="p">,</span>
        <span class="n">bias_regularizer</span><span class="o">=</span><span class="n">bias_regularizer</span><span class="p">,</span>
        <span class="n">activity_regularizer</span><span class="o">=</span><span class="n">activity_regularizer</span><span class="p">,</span>
        <span class="n">kernel_constraint</span><span class="o">=</span><span class="n">kernel_constraint</span><span class="p">,</span>
        <span class="n">bias_constraint</span><span class="o">=</span><span class="n">bias_constraint</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">set_klip_factor</span><span class="p">(</span><span class="n">k_coef_lip</span><span class="p">)</span>
    <span class="n">_check_RKO_params</span><span class="p">(</span><span class="n">eps_spectral</span><span class="p">,</span> <span class="n">eps_bjorck</span><span class="p">,</span> <span class="n">beta_bjorck</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">eps_spectral</span> <span class="o">=</span> <span class="n">eps_spectral</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">eps_bjorck</span> <span class="o">=</span> <span class="n">eps_bjorck</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">beta_bjorck</span> <span class="o">=</span> <span class="n">beta_bjorck</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">maxiter_bjorck</span> <span class="o">=</span> <span class="n">maxiter_bjorck</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">maxiter_spectral</span> <span class="o">=</span> <span class="n">maxiter_spectral</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">u</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sig</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">wbar</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">built</span> <span class="o">=</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>




  </div>

  </div>

</div>

<div class="doc doc-object doc-module">




<h2 id="deel.lip.layers.pooling" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">pooling</span>


<a href="#deel.lip.layers.pooling" class="headerlink" title="Permanent link">&para;</a></h2>

  <div class="doc doc-contents ">
  
      <p>This module extends original keras layers, in order to add k lipschitz constraint via
reparametrization. Currently, are implemented:
* Dense layer:
    as SpectralDense (and as FrobeniusDense when the layer has a single
    output)
* Conv2D layer:
    as SpectralConv2D (and as FrobeniusConv2D when the layer has a single
    output)
* AveragePooling:
    as ScaledAveragePooling
* GlobalAveragePooling2D:
    as ScaledGlobalAveragePooling2D
By default the layers are 1 Lipschitz almost everywhere, which is efficient for
wasserstein distance estimation. However for other problems (such as adversarial
robustness) the user may want to use layers that are at most 1 lipschitz, this can
be done by setting the param <code>eps_bjorck=None</code>.</p>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">




<h3 id="deel.lip.layers.pooling.InvertibleDownSampling" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">InvertibleDownSampling</span>


<a href="#deel.lip.layers.pooling.InvertibleDownSampling" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">InvertibleDownSampling</span><span class="p">(</span>
    <span class="n">pool_size</span><span class="p">,</span>
    <span class="n">data_format</span><span class="o">=</span><span class="s2">&quot;channels_last&quot;</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="tensorflow.Layer">Layer</span></code></p>

  
      <p>This pooling layer perform a reshape on the spacial dimensions: it take a
(bs, h, w, c) ( if channels_last ) and reshape it to a
(bs, h/p_h, w/p_w, c<em>p_w</em>p_h ), where p_w and p_h are the shape of the pool.
By doing this the image size is reduced while the number of channels is
increased.</p>

<details class="references" open>
  <summary>References</summary>
  <p>Anil et al. <a href="https://arxiv.org/abs/1911.00937">paper</a></p>
</details>
<details class="note" open>
  <summary>Note</summary>
  <p>The image shape must be divisible by the pool shape.</p>
</details>


  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b> DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>pool_size</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>tuple describing the pool shape</p>
            </div>
            <p>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>data_format</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>can either be <code>channels_last</code> or <code>channels_first</code></p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>&#39;channels_last&#39;</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>name of the layer</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>dtype</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>dtype of the layer</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>**kwargs</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>params passed to the Layers constructor</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>{}</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

                <details class="quote">
                  <summary>Source code in <code>deel/lip/layers/pooling.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">pool_size</span><span class="p">,</span> <span class="n">data_format</span><span class="o">=</span><span class="s2">&quot;channels_last&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    This pooling layer perform a reshape on the spacial dimensions: it take a</span>
<span class="sd">    (bs, h, w, c) ( if channels_last ) and reshape it to a</span>
<span class="sd">    (bs, h/p_h, w/p_w, c*p_w*p_h ), where p_w and p_h are the shape of the pool.</span>
<span class="sd">    By doing this the image size is reduced while the number of channels is</span>
<span class="sd">    increased.</span>

<span class="sd">    References:</span>
<span class="sd">        Anil et al. [paper](https://arxiv.org/abs/1911.00937)</span>

<span class="sd">    Note:</span>
<span class="sd">        The image shape must be divisible by the pool shape.</span>

<span class="sd">    Args:</span>
<span class="sd">        pool_size: tuple describing the pool shape</span>
<span class="sd">        data_format: can either be `channels_last` or `channels_first`</span>
<span class="sd">        name: name of the layer</span>
<span class="sd">        dtype: dtype of the layer</span>
<span class="sd">        **kwargs: params passed to the Layers constructor</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">InvertibleDownSampling</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pool_size</span> <span class="o">=</span> <span class="n">pool_size</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data_format</span> <span class="o">=</span> <span class="n">data_format</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h3 id="deel.lip.layers.pooling.InvertibleUpSampling" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">InvertibleUpSampling</span>


<a href="#deel.lip.layers.pooling.InvertibleUpSampling" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">InvertibleUpSampling</span><span class="p">(</span>
    <span class="n">pool_size</span><span class="p">,</span>
    <span class="n">data_format</span><span class="o">=</span><span class="s2">&quot;channels_last&quot;</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="tensorflow.Layer">Layer</span></code></p>

  
      <p>This Layer is the inverse of the InvertibleDownSampling layer. It take a
(bs, h, w, c) ( if channels_last ) and reshape it to a
(bs, h/p_h, w/p_w, c<em>p_w</em>p_h ), where p_w and p_h are the shape of the
pool. By doing this the image size is reduced while the number of
channels is increased.</p>

<details class="references" open>
  <summary>References</summary>
  <p>Anil et al. <a href="https://arxiv.org/abs/1911.00937">paper</a></p>
</details>
<details class="note" open>
  <summary>Note</summary>
  <p>The input number of channels must be divisible by the <code>p_w*p_h</code>.</p>
</details>


  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b> DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>pool_size</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>tuple describing the pool shape (p_h, p_w)</p>
            </div>
            <p>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>data_format</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>can either be <code>channels_last</code> or <code>channels_first</code></p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>&#39;channels_last&#39;</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>name of the layer</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>dtype</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>dtype of the layer</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>**kwargs</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>params passed to the Layers constructor</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>{}</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

                <details class="quote">
                  <summary>Source code in <code>deel/lip/layers/pooling.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">pool_size</span><span class="p">,</span> <span class="n">data_format</span><span class="o">=</span><span class="s2">&quot;channels_last&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    This Layer is the inverse of the InvertibleDownSampling layer. It take a</span>
<span class="sd">    (bs, h, w, c) ( if channels_last ) and reshape it to a</span>
<span class="sd">    (bs, h/p_h, w/p_w, c*p_w*p_h ), where p_w and p_h are the shape of the</span>
<span class="sd">    pool. By doing this the image size is reduced while the number of</span>
<span class="sd">    channels is increased.</span>

<span class="sd">    References:</span>
<span class="sd">        Anil et al. [paper](https://arxiv.org/abs/1911.00937)</span>

<span class="sd">    Note:</span>
<span class="sd">        The input number of channels must be divisible by the `p_w*p_h`.</span>


<span class="sd">    Args:</span>
<span class="sd">        pool_size: tuple describing the pool shape (p_h, p_w)</span>
<span class="sd">        data_format: can either be `channels_last` or `channels_first`</span>
<span class="sd">        name: name of the layer</span>
<span class="sd">        dtype: dtype of the layer</span>
<span class="sd">        **kwargs: params passed to the Layers constructor</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">InvertibleUpSampling</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pool_size</span> <span class="o">=</span> <span class="n">pool_size</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data_format</span> <span class="o">=</span> <span class="n">data_format</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h3 id="deel.lip.layers.pooling.ScaledAveragePooling2D" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">ScaledAveragePooling2D</span>


<a href="#deel.lip.layers.pooling.ScaledAveragePooling2D" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">ScaledAveragePooling2D</span><span class="p">(</span>
    <span class="n">pool_size</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
    <span class="n">strides</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">padding</span><span class="o">=</span><span class="s2">&quot;valid&quot;</span><span class="p">,</span>
    <span class="n">data_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">k_coef_lip</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="tensorflow.AveragePooling2D">AveragePooling2D</span></code>, <code><a class="autorefs autorefs-internal" title="deel.lip.layers.base_layer.LipschitzLayer" href="#deel.lip.layers.base_layer.LipschitzLayer">LipschitzLayer</a></code></p>

  
      <p>Average pooling operation for spatial data, but with a lipschitz bound.</p>



  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b> DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>pool_size</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>integer or tuple of 2 integers,
factors by which to downscale (vertical, horizontal).
<code>(2, 2)</code> will halve the input in both spatial dimension.
If only one integer is specified, the same window length
will be used for both dimensions.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>(2, 2)</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>strides</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Integer, tuple of 2 integers, or None.
Strides values.
If None, it will default to <code>pool_size</code>.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>padding</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>One of <code>"valid"</code> or <code>"same"</code> (case-insensitive).</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>&#39;valid&#39;</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>data_format</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>A string,
one of <code>channels_last</code> (default) or <code>channels_first</code>.
The ordering of the dimensions in the inputs.
<code>channels_last</code> corresponds to inputs with shape
<code>(batch, height, width, channels)</code> while <code>channels_first</code>
corresponds to inputs with shape
<code>(batch, channels, height, width)</code>.
It defaults to the <code>image_data_format</code> value found in your
Keras config file at <code>~/.keras/keras.json</code>.
If you never set it, then it will be "channels_last".</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>k_coef_lip</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>the lipschitz factor to ensure</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>1.0</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

<details class="input-shape" open>
  <summary>Input shape</summary>
  <ul>
<li>If <code>data_format='channels_last'</code>:
    4D tensor with shape <code>(batch_size, rows, cols, channels)</code>.</li>
<li>If <code>data_format='channels_first'</code>:
    4D tensor with shape <code>(batch_size, channels, rows, cols)</code>.</li>
</ul>
</details>
<details class="output-shape" open>
  <summary>Output shape</summary>
  <ul>
<li>If <code>data_format='channels_last'</code>:
    4D tensor with shape <code>(batch_size, pooled_rows, pooled_cols, channels)</code>.</li>
<li>If <code>data_format='channels_first'</code>:
    4D tensor with shape <code>(batch_size, channels, pooled_rows, pooled_cols)</code>.</li>
</ul>
</details>      <p>This documentation reuse the body of the original keras.layers.AveragePooling2D
doc.</p>

                <details class="quote">
                  <summary>Source code in <code>deel/lip/layers/pooling.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">pool_size</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
    <span class="n">strides</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">padding</span><span class="o">=</span><span class="s2">&quot;valid&quot;</span><span class="p">,</span>
    <span class="n">data_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">k_coef_lip</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Average pooling operation for spatial data, but with a lipschitz bound.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        pool_size: integer or tuple of 2 integers,</span>
<span class="sd">            factors by which to downscale (vertical, horizontal).</span>
<span class="sd">            `(2, 2)` will halve the input in both spatial dimension.</span>
<span class="sd">            If only one integer is specified, the same window length</span>
<span class="sd">            will be used for both dimensions.</span>
<span class="sd">        strides: Integer, tuple of 2 integers, or None.</span>
<span class="sd">            Strides values.</span>
<span class="sd">            If None, it will default to `pool_size`.</span>
<span class="sd">        padding: One of `&quot;valid&quot;` or `&quot;same&quot;` (case-insensitive).</span>
<span class="sd">        data_format: A string,</span>
<span class="sd">            one of `channels_last` (default) or `channels_first`.</span>
<span class="sd">            The ordering of the dimensions in the inputs.</span>
<span class="sd">            `channels_last` corresponds to inputs with shape</span>
<span class="sd">            `(batch, height, width, channels)` while `channels_first`</span>
<span class="sd">            corresponds to inputs with shape</span>
<span class="sd">            `(batch, channels, height, width)`.</span>
<span class="sd">            It defaults to the `image_data_format` value found in your</span>
<span class="sd">            Keras config file at `~/.keras/keras.json`.</span>
<span class="sd">            If you never set it, then it will be &quot;channels_last&quot;.</span>
<span class="sd">        k_coef_lip: the lipschitz factor to ensure</span>

<span class="sd">    Input shape:</span>
<span class="sd">        - If `data_format=&#39;channels_last&#39;`:</span>
<span class="sd">            4D tensor with shape `(batch_size, rows, cols, channels)`.</span>
<span class="sd">        - If `data_format=&#39;channels_first&#39;`:</span>
<span class="sd">            4D tensor with shape `(batch_size, channels, rows, cols)`.</span>

<span class="sd">    Output shape:</span>
<span class="sd">        - If `data_format=&#39;channels_last&#39;`:</span>
<span class="sd">            4D tensor with shape `(batch_size, pooled_rows, pooled_cols, channels)`.</span>
<span class="sd">        - If `data_format=&#39;channels_first&#39;`:</span>
<span class="sd">            4D tensor with shape `(batch_size, channels, pooled_rows, pooled_cols)`.</span>

<span class="sd">    This documentation reuse the body of the original keras.layers.AveragePooling2D</span>
<span class="sd">    doc.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">((</span><span class="n">strides</span> <span class="o">==</span> <span class="n">pool_size</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">strides</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;stride must be equal to pool_size&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">padding</span> <span class="o">!=</span> <span class="s2">&quot;valid&quot;</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;ScaledAveragePooling2D only supports padding=&#39;valid&#39;&quot;</span><span class="p">)</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">ScaledAveragePooling2D</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">pool_size</span><span class="o">=</span><span class="n">pool_size</span><span class="p">,</span>
        <span class="n">strides</span><span class="o">=</span><span class="n">pool_size</span><span class="p">,</span>
        <span class="n">padding</span><span class="o">=</span><span class="n">padding</span><span class="p">,</span>
        <span class="n">data_format</span><span class="o">=</span><span class="n">data_format</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">set_klip_factor</span><span class="p">(</span><span class="n">k_coef_lip</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h3 id="deel.lip.layers.pooling.ScaledGlobalAveragePooling2D" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">ScaledGlobalAveragePooling2D</span>


<a href="#deel.lip.layers.pooling.ScaledGlobalAveragePooling2D" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">ScaledGlobalAveragePooling2D</span><span class="p">(</span>
    <span class="n">data_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">k_coef_lip</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="tensorflow.GlobalAveragePooling2D">GlobalAveragePooling2D</span></code>, <code><a class="autorefs autorefs-internal" title="deel.lip.layers.base_layer.LipschitzLayer" href="#deel.lip.layers.base_layer.LipschitzLayer">LipschitzLayer</a></code></p>

  
      <p>Global average pooling operation for spatial data with Lipschitz bound.</p>



  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b> DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data_format</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>A string,
one of <code>channels_last</code> (default) or <code>channels_first</code>.
The ordering of the dimensions in the inputs.
<code>channels_last</code> corresponds to inputs with shape
<code>(batch, height, width, channels)</code> while <code>channels_first</code>
corresponds to inputs with shape
<code>(batch, channels, height, width)</code>.
It defaults to the <code>image_data_format</code> value found in your
Keras config file at <code>~/.keras/keras.json</code>.
If you never set it, then it will be "channels_last".</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

<details class="input-shape" open>
  <summary>Input shape</summary>
  <ul>
<li>If <code>data_format='channels_last'</code>:
    4D tensor with shape <code>(batch_size, rows, cols, channels)</code>.</li>
<li>If <code>data_format='channels_first'</code>:
    4D tensor with shape <code>(batch_size, channels, rows, cols)</code>.</li>
</ul>
</details>      <p>Output shape:
2D tensor with shape <code>(batch_size, channels)</code>.</p>
<p>This documentation reuse the body of the original
keras.layers.GlobalAveragePooling doc.</p>

                <details class="quote">
                  <summary>Source code in <code>deel/lip/layers/pooling.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">k_coef_lip</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Global average pooling operation for spatial data with Lipschitz bound.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        data_format: A string,</span>
<span class="sd">            one of `channels_last` (default) or `channels_first`.</span>
<span class="sd">            The ordering of the dimensions in the inputs.</span>
<span class="sd">            `channels_last` corresponds to inputs with shape</span>
<span class="sd">            `(batch, height, width, channels)` while `channels_first`</span>
<span class="sd">            corresponds to inputs with shape</span>
<span class="sd">            `(batch, channels, height, width)`.</span>
<span class="sd">            It defaults to the `image_data_format` value found in your</span>
<span class="sd">            Keras config file at `~/.keras/keras.json`.</span>
<span class="sd">            If you never set it, then it will be &quot;channels_last&quot;.</span>

<span class="sd">    Input shape:</span>
<span class="sd">        - If `data_format=&#39;channels_last&#39;`:</span>
<span class="sd">            4D tensor with shape `(batch_size, rows, cols, channels)`.</span>
<span class="sd">        - If `data_format=&#39;channels_first&#39;`:</span>
<span class="sd">            4D tensor with shape `(batch_size, channels, rows, cols)`.</span>

<span class="sd">    Output shape:</span>
<span class="sd">    2D tensor with shape `(batch_size, channels)`.</span>

<span class="sd">    This documentation reuse the body of the original</span>
<span class="sd">    keras.layers.GlobalAveragePooling doc.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">ScaledGlobalAveragePooling2D</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">data_format</span><span class="o">=</span><span class="n">data_format</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">set_klip_factor</span><span class="p">(</span><span class="n">k_coef_lip</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h3 id="deel.lip.layers.pooling.ScaledGlobalL2NormPooling2D" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">ScaledGlobalL2NormPooling2D</span>


<a href="#deel.lip.layers.pooling.ScaledGlobalL2NormPooling2D" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">ScaledGlobalL2NormPooling2D</span><span class="p">(</span>
    <span class="n">data_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">k_coef_lip</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">eps_grad_sqrt</span><span class="o">=</span><span class="mf">1e-06</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="tensorflow.GlobalAveragePooling2D">GlobalAveragePooling2D</span></code>, <code><a class="autorefs autorefs-internal" title="deel.lip.layers.base_layer.LipschitzLayer" href="#deel.lip.layers.base_layer.LipschitzLayer">LipschitzLayer</a></code></p>

  
      <p>Average pooling operation for spatial data, with a lipschitz bound. This
pooling operation is norm preserving (aka gradient=1 almost everywhere).</p>
<p>[1]Y.-L.Boureau, J.Ponce, et Y.LeCun, « A Theoretical Analysis of Feature
Pooling in Visual Recognition »,p.8.</p>



  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b> DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data_format</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>A string,
one of <code>channels_last</code> (default) or <code>channels_first</code>.
The ordering of the dimensions in the inputs.
<code>channels_last</code> corresponds to inputs with shape
<code>(batch, height, width, channels)</code> while <code>channels_first</code>
corresponds to inputs with shape
<code>(batch, channels, height, width)</code>.
It defaults to the <code>image_data_format</code> value found in your
Keras config file at <code>~/.keras/keras.json</code>.
If you never set it, then it will be "channels_last".</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>k_coef_lip</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>the lipschitz factor to ensure</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>1.0</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>eps_grad_sqrt</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Epsilon value to avoid numerical instability
due to non-defined gradient at 0 in the sqrt function</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>1e-06</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

<details class="input-shape" open>
  <summary>Input shape</summary>
  <ul>
<li>If <code>data_format='channels_last'</code>:
    4D tensor with shape <code>(batch_size, rows, cols, channels)</code>.</li>
<li>If <code>data_format='channels_first'</code>:
    4D tensor with shape <code>(batch_size, channels, rows, cols)</code>.</li>
</ul>
</details>
<details class="output-shape" open>
  <summary>Output shape</summary>
  <ul>
<li>If <code>data_format='channels_last'</code>:
    4D tensor with shape <code>(batch_size, channels)</code>.</li>
<li>If <code>data_format='channels_first'</code>:
    4D tensor with shape <code>(batch_size, pooled_cols)</code>.</li>
</ul>
</details>
                <details class="quote">
                  <summary>Source code in <code>deel/lip/layers/pooling.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">k_coef_lip</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">eps_grad_sqrt</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Average pooling operation for spatial data, with a lipschitz bound. This</span>
<span class="sd">    pooling operation is norm preserving (aka gradient=1 almost everywhere).</span>

<span class="sd">    [1]Y.-L.Boureau, J.Ponce, et Y.LeCun, « A Theoretical Analysis of Feature</span>
<span class="sd">    Pooling in Visual Recognition »,p.8.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        data_format: A string,</span>
<span class="sd">            one of `channels_last` (default) or `channels_first`.</span>
<span class="sd">            The ordering of the dimensions in the inputs.</span>
<span class="sd">            `channels_last` corresponds to inputs with shape</span>
<span class="sd">            `(batch, height, width, channels)` while `channels_first`</span>
<span class="sd">            corresponds to inputs with shape</span>
<span class="sd">            `(batch, channels, height, width)`.</span>
<span class="sd">            It defaults to the `image_data_format` value found in your</span>
<span class="sd">            Keras config file at `~/.keras/keras.json`.</span>
<span class="sd">            If you never set it, then it will be &quot;channels_last&quot;.</span>
<span class="sd">        k_coef_lip: the lipschitz factor to ensure</span>
<span class="sd">        eps_grad_sqrt: Epsilon value to avoid numerical instability</span>
<span class="sd">            due to non-defined gradient at 0 in the sqrt function</span>

<span class="sd">    Input shape:</span>
<span class="sd">        - If `data_format=&#39;channels_last&#39;`:</span>
<span class="sd">            4D tensor with shape `(batch_size, rows, cols, channels)`.</span>
<span class="sd">        - If `data_format=&#39;channels_first&#39;`:</span>
<span class="sd">            4D tensor with shape `(batch_size, channels, rows, cols)`.</span>

<span class="sd">    Output shape:</span>
<span class="sd">        - If `data_format=&#39;channels_last&#39;`:</span>
<span class="sd">            4D tensor with shape `(batch_size, channels)`.</span>
<span class="sd">        - If `data_format=&#39;channels_first&#39;`:</span>
<span class="sd">            4D tensor with shape `(batch_size, pooled_cols)`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">eps_grad_sqrt</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;eps_grad_sqrt must be positive&quot;</span><span class="p">)</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">ScaledGlobalL2NormPooling2D</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">data_format</span><span class="o">=</span><span class="n">data_format</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">set_klip_factor</span><span class="p">(</span><span class="n">k_coef_lip</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">eps_grad_sqrt</span> <span class="o">=</span> <span class="n">eps_grad_sqrt</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_format</span> <span class="o">==</span> <span class="s2">&quot;channels_last&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h3 id="deel.lip.layers.pooling.ScaledL2NormPooling2D" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">ScaledL2NormPooling2D</span>


<a href="#deel.lip.layers.pooling.ScaledL2NormPooling2D" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">ScaledL2NormPooling2D</span><span class="p">(</span>
    <span class="n">pool_size</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
    <span class="n">strides</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">padding</span><span class="o">=</span><span class="s2">&quot;valid&quot;</span><span class="p">,</span>
    <span class="n">data_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">k_coef_lip</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">eps_grad_sqrt</span><span class="o">=</span><span class="mf">1e-06</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="tensorflow.AveragePooling2D">AveragePooling2D</span></code>, <code><a class="autorefs autorefs-internal" title="deel.lip.layers.base_layer.LipschitzLayer" href="#deel.lip.layers.base_layer.LipschitzLayer">LipschitzLayer</a></code></p>

  
      <p>Average pooling operation for spatial data, with a lipschitz bound. This
pooling operation is norm preserving (aka gradient=1 almost everywhere).</p>
<p>[1]Y.-L.Boureau, J.Ponce, et Y.LeCun, « A Theoretical Analysis of Feature
Pooling in Visual Recognition »,p.8.</p>



  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b> DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>pool_size</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>integer or tuple of 2 integers,
factors by which to downscale (vertical, horizontal).
<code>(2, 2)</code> will halve the input in both spatial dimension.
If only one integer is specified, the same window length
will be used for both dimensions.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>(2, 2)</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>strides</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Integer, tuple of 2 integers, or None.
Strides values.
If None, it will default to <code>pool_size</code>.</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>padding</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>One of <code>"valid"</code> or <code>"same"</code> (case-insensitive).</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>&#39;valid&#39;</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>data_format</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>A string,
one of <code>channels_last</code> (default) or <code>channels_first</code>.
The ordering of the dimensions in the inputs.
<code>channels_last</code> corresponds to inputs with shape
<code>(batch, height, width, channels)</code> while <code>channels_first</code>
corresponds to inputs with shape
<code>(batch, channels, height, width)</code>.
It defaults to the <code>image_data_format</code> value found in your
Keras config file at <code>~/.keras/keras.json</code>.
If you never set it, then it will be "channels_last".</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>k_coef_lip</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>the lipschitz factor to ensure</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>1.0</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>eps_grad_sqrt</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Epsilon value to avoid numerical instability
due to non-defined gradient at 0 in the sqrt function</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>1e-06</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

<details class="input-shape" open>
  <summary>Input shape</summary>
  <ul>
<li>If <code>data_format='channels_last'</code>:
    4D tensor with shape <code>(batch_size, rows, cols, channels)</code>.</li>
<li>If <code>data_format='channels_first'</code>:
    4D tensor with shape <code>(batch_size, channels, rows, cols)</code>.</li>
</ul>
</details>
<details class="output-shape" open>
  <summary>Output shape</summary>
  <ul>
<li>If <code>data_format='channels_last'</code>:
    4D tensor with shape <code>(batch_size, pooled_rows, pooled_cols, channels)</code>.</li>
<li>If <code>data_format='channels_first'</code>:
    4D tensor with shape <code>(batch_size, channels, pooled_rows, pooled_cols)</code>.</li>
</ul>
</details>
                <details class="quote">
                  <summary>Source code in <code>deel/lip/layers/pooling.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">pool_size</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
    <span class="n">strides</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">padding</span><span class="o">=</span><span class="s2">&quot;valid&quot;</span><span class="p">,</span>
    <span class="n">data_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">k_coef_lip</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">eps_grad_sqrt</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Average pooling operation for spatial data, with a lipschitz bound. This</span>
<span class="sd">    pooling operation is norm preserving (aka gradient=1 almost everywhere).</span>

<span class="sd">    [1]Y.-L.Boureau, J.Ponce, et Y.LeCun, « A Theoretical Analysis of Feature</span>
<span class="sd">    Pooling in Visual Recognition »,p.8.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        pool_size: integer or tuple of 2 integers,</span>
<span class="sd">            factors by which to downscale (vertical, horizontal).</span>
<span class="sd">            `(2, 2)` will halve the input in both spatial dimension.</span>
<span class="sd">            If only one integer is specified, the same window length</span>
<span class="sd">            will be used for both dimensions.</span>
<span class="sd">        strides: Integer, tuple of 2 integers, or None.</span>
<span class="sd">            Strides values.</span>
<span class="sd">            If None, it will default to `pool_size`.</span>
<span class="sd">        padding: One of `&quot;valid&quot;` or `&quot;same&quot;` (case-insensitive).</span>
<span class="sd">        data_format: A string,</span>
<span class="sd">            one of `channels_last` (default) or `channels_first`.</span>
<span class="sd">            The ordering of the dimensions in the inputs.</span>
<span class="sd">            `channels_last` corresponds to inputs with shape</span>
<span class="sd">            `(batch, height, width, channels)` while `channels_first`</span>
<span class="sd">            corresponds to inputs with shape</span>
<span class="sd">            `(batch, channels, height, width)`.</span>
<span class="sd">            It defaults to the `image_data_format` value found in your</span>
<span class="sd">            Keras config file at `~/.keras/keras.json`.</span>
<span class="sd">            If you never set it, then it will be &quot;channels_last&quot;.</span>
<span class="sd">        k_coef_lip: the lipschitz factor to ensure</span>
<span class="sd">        eps_grad_sqrt: Epsilon value to avoid numerical instability</span>
<span class="sd">            due to non-defined gradient at 0 in the sqrt function</span>

<span class="sd">    Input shape:</span>
<span class="sd">        - If `data_format=&#39;channels_last&#39;`:</span>
<span class="sd">            4D tensor with shape `(batch_size, rows, cols, channels)`.</span>
<span class="sd">        - If `data_format=&#39;channels_first&#39;`:</span>
<span class="sd">            4D tensor with shape `(batch_size, channels, rows, cols)`.</span>

<span class="sd">    Output shape:</span>
<span class="sd">        - If `data_format=&#39;channels_last&#39;`:</span>
<span class="sd">            4D tensor with shape `(batch_size, pooled_rows, pooled_cols, channels)`.</span>
<span class="sd">        - If `data_format=&#39;channels_first&#39;`:</span>
<span class="sd">            4D tensor with shape `(batch_size, channels, pooled_rows, pooled_cols)`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">((</span><span class="n">strides</span> <span class="o">==</span> <span class="n">pool_size</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">strides</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;stride must be equal to pool_size&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">padding</span> <span class="o">!=</span> <span class="s2">&quot;valid&quot;</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;ScaledL2NormPooling2D only supports padding=&#39;valid&#39;&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">eps_grad_sqrt</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;eps_grad_sqrt must be positive&quot;</span><span class="p">)</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">ScaledL2NormPooling2D</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">pool_size</span><span class="o">=</span><span class="n">pool_size</span><span class="p">,</span>
        <span class="n">strides</span><span class="o">=</span><span class="n">pool_size</span><span class="p">,</span>
        <span class="n">padding</span><span class="o">=</span><span class="n">padding</span><span class="p">,</span>
        <span class="n">data_format</span><span class="o">=</span><span class="n">data_format</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">set_klip_factor</span><span class="p">(</span><span class="n">k_coef_lip</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">eps_grad_sqrt</span> <span class="o">=</span> <span class="n">eps_grad_sqrt</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>




  </div>

  </div>

</div>

<div class="doc doc-object doc-module">




<h2 id="deel.lip.layers.unconstrained" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">unconstrained</span>


<a href="#deel.lip.layers.unconstrained" class="headerlink" title="Permanent link">&para;</a></h2>

  <div class="doc doc-contents ">
  
      <p>This module contains custom Keras unconstrained layers.</p>
<p>Compared to other files in <code>layers</code> folder, the layers defined here are not
Lipschitz-constrained. They are base classes for more advanced layers. Do not use these
layers as is, since they are not Lipschitz constrained.</p>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">




<h3 id="deel.lip.layers.unconstrained.PadConv2D" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">PadConv2D</span>


<a href="#deel.lip.layers.unconstrained.PadConv2D" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">PadConv2D</span><span class="p">(</span>
    <span class="n">filters</span><span class="p">,</span>
    <span class="n">kernel_size</span><span class="p">,</span>
    <span class="n">strides</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">padding</span><span class="o">=</span><span class="s2">&quot;same&quot;</span><span class="p">,</span>
    <span class="n">data_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">dilation_rate</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">activation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="o">=</span><span class="s2">&quot;glorot_uniform&quot;</span><span class="p">,</span>
    <span class="n">bias_initializer</span><span class="o">=</span><span class="s2">&quot;zeros&quot;</span><span class="p">,</span>
    <span class="n">kernel_regularizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">bias_regularizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">activity_regularizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">kernel_constraint</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">bias_constraint</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="tensorflow.keras.layers.Conv2D">Conv2D</span></code>, <code><a class="autorefs autorefs-internal" title="deel.lip.layers.base_layer.Condensable" href="#deel.lip.layers.base_layer.Condensable">Condensable</a></code></p>

  
      <p>This class is a Conv2D Layer with parameterized padding.
Since Conv2D layer only supports <code>"same"</code> and <code>"valid"</code> padding, this layer will
enable other type of padding, such as <code>"constant"</code>, <code>"symmetric"</code>, <code>"reflect"</code>
or <code>"circular"</code>.</p>

<details class="warning" open>
  <summary>Warning</summary>
  <p>The PadConv2D is not a Lipschitz layer and must not be directly used. This
must be used as a base class to create a Lipschitz layer with padding.</p>
</details>      <p>All arguments are the same as the original <code>Conv2D</code> except the <code>padding</code>
which is defined as following:</p>



  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b> DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>padding</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>one of <code>"same"</code>, <code>"valid"</code> <code>"constant"</code>, <code>"symmetric"</code>,
<code>"reflect"</code> or <code>"circular"</code> (case-insensitive).</p>
            </div>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>&#39;same&#39;</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

                <details class="quote">
                  <summary>Source code in <code>deel/lip/layers/unconstrained.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">filters</span><span class="p">,</span>
    <span class="n">kernel_size</span><span class="p">,</span>
    <span class="n">strides</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">padding</span><span class="o">=</span><span class="s2">&quot;same&quot;</span><span class="p">,</span>
    <span class="n">data_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">dilation_rate</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">activation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="o">=</span><span class="s2">&quot;glorot_uniform&quot;</span><span class="p">,</span>
    <span class="n">bias_initializer</span><span class="o">=</span><span class="s2">&quot;zeros&quot;</span><span class="p">,</span>
    <span class="n">kernel_regularizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">bias_regularizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">activity_regularizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">kernel_constraint</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">bias_constraint</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class is a Conv2D Layer with parameterized padding.</span>
<span class="sd">    Since Conv2D layer only supports `&quot;same&quot;` and `&quot;valid&quot;` padding, this layer will</span>
<span class="sd">    enable other type of padding, such as `&quot;constant&quot;`, `&quot;symmetric&quot;`, `&quot;reflect&quot;`</span>
<span class="sd">    or `&quot;circular&quot;`.</span>

<span class="sd">    Warning:</span>
<span class="sd">        The PadConv2D is not a Lipschitz layer and must not be directly used. This</span>
<span class="sd">        must be used as a base class to create a Lipschitz layer with padding.</span>

<span class="sd">    All arguments are the same as the original `Conv2D` except the `padding`</span>
<span class="sd">    which is defined as following:</span>

<span class="sd">    Args:</span>
<span class="sd">        padding: one of `&quot;same&quot;`, `&quot;valid&quot;` `&quot;constant&quot;`, `&quot;symmetric&quot;`,</span>
<span class="sd">            `&quot;reflect&quot;` or `&quot;circular&quot;` (case-insensitive).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pad</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">old_padding</span> <span class="o">=</span> <span class="n">padding</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">internal_input_shape</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">padding</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">!=</span> <span class="s2">&quot;same&quot;</span><span class="p">:</span>  <span class="c1"># same is directly processed in Conv2D</span>
        <span class="n">padding</span> <span class="o">=</span> <span class="s2">&quot;valid&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">PadConv2D</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">,</span>
        <span class="n">kernel_size</span><span class="o">=</span><span class="n">kernel_size</span><span class="p">,</span>
        <span class="n">strides</span><span class="o">=</span><span class="n">strides</span><span class="p">,</span>
        <span class="n">padding</span><span class="o">=</span><span class="n">padding</span><span class="p">,</span>
        <span class="n">data_format</span><span class="o">=</span><span class="n">data_format</span><span class="p">,</span>
        <span class="n">dilation_rate</span><span class="o">=</span><span class="n">dilation_rate</span><span class="p">,</span>
        <span class="n">activation</span><span class="o">=</span><span class="n">activation</span><span class="p">,</span>
        <span class="n">use_bias</span><span class="o">=</span><span class="n">use_bias</span><span class="p">,</span>
        <span class="n">kernel_initializer</span><span class="o">=</span><span class="n">kernel_initializer</span><span class="p">,</span>
        <span class="n">bias_initializer</span><span class="o">=</span><span class="n">bias_initializer</span><span class="p">,</span>
        <span class="n">kernel_regularizer</span><span class="o">=</span><span class="n">kernel_regularizer</span><span class="p">,</span>
        <span class="n">bias_regularizer</span><span class="o">=</span><span class="n">bias_regularizer</span><span class="p">,</span>
        <span class="n">activity_regularizer</span><span class="o">=</span><span class="n">activity_regularizer</span><span class="p">,</span>
        <span class="n">kernel_constraint</span><span class="o">=</span><span class="n">kernel_constraint</span><span class="p">,</span>
        <span class="n">bias_constraint</span><span class="o">=</span><span class="n">bias_constraint</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">old_padding</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;same&quot;</span><span class="p">,</span> <span class="s2">&quot;valid&quot;</span><span class="p">]:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pad</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">padding_size</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">old_padding</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;constant&quot;</span><span class="p">,</span> <span class="s2">&quot;reflect&quot;</span><span class="p">,</span> <span class="s2">&quot;symmetric&quot;</span><span class="p">]:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">padding_size</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernel_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span>
        <span class="n">paddings</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">padding_size</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">padding_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">padding_size</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">padding_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pad</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">paddings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">old_padding</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">old_padding</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;circular&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">padding_size</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernel_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pad</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">_padding_circular</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">padding_size</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>




  </div>

  </div>

</div>


  </div>

  </div>

</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.aecac24b.min.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="../../js/custom.js"></script>
      
    
  </body>
</html>