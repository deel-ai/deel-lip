
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../demo0/">
      
      
        <link rel="next" href="../demo2/">
      
      <link rel="icon" href="../../assets/lip_logo.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.0.15">
    
    
      
        <title>Demo 1: Wasserstein distance estimation on toy example - DEEL-LIP</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.113286f1.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.a0c5b2b5.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../css/custom.css">
    
      <link rel="stylesheet" href="../../css/ansi-colours.css">
    
      <link rel="stylesheet" href="../../css/jupyter-cells.css">
    
      <link rel="stylesheet" href="../../css/pandas-dataframe.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="dark" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#demo-1-wasserstein-distance-estimation-on-toy-example" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="DEEL-LIP" class="md-header__button md-logo" aria-label="DEEL-LIP" data-md-component="logo">
      
  <img src="../../assets/lip_logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            DEEL-LIP
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Demo 1: Wasserstein distance estimation on toy example
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="dark" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
            </label>
          
        
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/deel-ai/deel-lip" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    deel-ai/deel-lip
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="DEEL-LIP" class="md-nav__button md-logo" aria-label="DEEL-LIP" data-md-component="logo">
      
  <img src="../../assets/lip_logo.png" alt="logo">

    </a>
    DEEL-LIP
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/deel-ai/deel-lip" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    deel-ai/deel-lip
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          API Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          API Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../api/activations/" class="md-nav__link">
        deel.lip.activations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../api/callbacks/" class="md-nav__link">
        deel.lip.callbacks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../api/constraints/" class="md-nav__link">
        deel.lip.constraints
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../api/initializers/" class="md-nav__link">
        deel.lip.initializers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../api/layers/" class="md-nav__link">
        deel.lip.layers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../api/losses/" class="md-nav__link">
        deel.lip.losses
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../api/metrics/" class="md-nav__link">
        deel.lip.metrics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../api/model/" class="md-nav__link">
        deel.lip.model
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../api/normalizers/" class="md-nav__link">
        deel.lip.normalizers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../api/utils/" class="md-nav__link">
        deel.lip.utils
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Tutorials
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../demo0/" class="md-nav__link">
        Demo 0: Example & Usage
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Demo 1: Wasserstein distance estimation on toy example
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Demo 1: Wasserstein distance estimation on toy example
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#demo-1-wasserstein-distance-estimation-on-toy-example" class="md-nav__link">
    Demo 1: Wasserstein distance estimation on toy example
  </a>
  
    <nav class="md-nav" aria-label="Demo 1: Wasserstein distance estimation on toy example">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wasserstein-distance" class="md-nav__link">
    Wasserstein distance
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kr-dual-formulation" class="md-nav__link">
    KR dual formulation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parameters-input-images" class="md-nav__link">
    Parameters input images
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generate-images" class="md-nav__link">
    Generate images
  </a>
  
    <nav class="md-nav" aria-label="Generate images">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#for-binary-generator" class="md-nav__link">
    for binary generator
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#for-ternary-generator" class="md-nav__link">
    for ternary generator
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#expe-parameters" class="md-nav__link">
    Expe parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-lipschitz-model" class="md-nav__link">
    Build lipschitz Model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#learn-on-toy-dataset" class="md-nav__link">
    Learn on toy dataset
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../demo2/" class="md-nav__link">
        Demo 2: HKR Classifier on toy dataset
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../demo3/" class="md-nav__link">
        Demo 3: HKR Classifier on MNIST dataset
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../demo4/" class="md-nav__link">
        Demo 4: HKR Multiclass and fooling
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#demo-1-wasserstein-distance-estimation-on-toy-example" class="md-nav__link">
    Demo 1: Wasserstein distance estimation on toy example
  </a>
  
    <nav class="md-nav" aria-label="Demo 1: Wasserstein distance estimation on toy example">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wasserstein-distance" class="md-nav__link">
    Wasserstein distance
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kr-dual-formulation" class="md-nav__link">
    KR dual formulation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parameters-input-images" class="md-nav__link">
    Parameters input images
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generate-images" class="md-nav__link">
    Generate images
  </a>
  
    <nav class="md-nav" aria-label="Generate images">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#for-binary-generator" class="md-nav__link">
    for binary generator
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#for-ternary-generator" class="md-nav__link">
    for ternary generator
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#expe-parameters" class="md-nav__link">
    Expe parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-lipschitz-model" class="md-nav__link">
    Build lipschitz Model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#learn-on-toy-dataset" class="md-nav__link">
    Learn on toy dataset
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>Demo 1: Wasserstein distance estimation on toy example</h1>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script>
(function() {
  function addWidgetsRenderer() {
    var requireJsScript = document.createElement('script');
    requireJsScript.src = 'https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js';

    var mimeElement = document.querySelector('script[type="application/vnd.jupyter.widget-view+json"]');
    var jupyterWidgetsScript = document.createElement('script');
    var widgetRendererSrc = 'https://unpkg.com/@jupyter-widgets/html-manager@*/dist/embed-amd.js';
    var widgetState;

    // Fallback for older version:
    try {
      widgetState = mimeElement && JSON.parse(mimeElement.innerHTML);

      if (widgetState && (widgetState.version_major < 2 || !widgetState.version_major)) {
        widgetRendererSrc = 'jupyter-js-widgets@*/dist/embed.js';
      }
    } catch(e) {}

    jupyterWidgetsScript.src = widgetRendererSrc;

    document.body.appendChild(requireJsScript);
    document.body.appendChild(jupyterWidgetsScript);
  }

  document.addEventListener('DOMContentLoaded', addWidgetsRenderer);
}());
</script>

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="demo-1-wasserstein-distance-estimation-on-toy-example">Demo 1: Wasserstein distance estimation on toy example<a class="headerlink" href="#demo-1-wasserstein-distance-estimation-on-toy-example" title="Permanent link">&para;</a></h2>
<p><a href="https://colab.research.google.com/github/deel-ai/deel-lip/blob/master/docs/notebooks/demo1.ipynb"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></a></p>
<p>In this notebook we will see how to estimate the wasserstein distance with a Neural net by using
the Kantorovich-Rubinestein dual representation.</p>
<h3 id="wasserstein-distance">Wasserstein distance<a class="headerlink" href="#wasserstein-distance" title="Permanent link">&para;</a></h3>
<p>The wasserstein distance measure the distance between two probability distribution. Wikipedia article gives a more intuitive definition of it:</p>
<blockquote>
<p>Intuitively, if each distribution is viewed as a unit amount of "dirt" piled on M, the metric is the minimum "cost" of turning one pile into the other, which is assumed to be the amount of dirt that needs to be moved times the mean distance it has to be moved. Because of this analogy, the metric is known in computer science as the earth mover's distance.</p>
</blockquote>
<p>Mathematically it is defined as:</p>
<div class="arithmatex">\[
W_1(\mu,\nu) = \inf_{\pi \in \Pi(\mu,\nu)}\underset{x,z \sim \pi}{\mathbb{E}}\parallel \textbf{x}-\textbf{z} \parallel
\]</div>
<p>where <span class="arithmatex">\(\Pi(\mu,\nu)\)</span> is the set of all probability measures on <span class="arithmatex">\(\Omega\times \Omega\)</span> with marginals <span class="arithmatex">\(\mu\)</span> and <span class="arithmatex">\(\nu\)</span>. In most case this equation is not tractable.</p>
<h3 id="kr-dual-formulation">KR dual formulation<a class="headerlink" href="#kr-dual-formulation" title="Permanent link">&para;</a></h3>
<p>In our setup, the KR dual formulation is stated as following:
$$ W_1(\mu, \nu) = \sup_{f \in Lip_1(\Omega)} \underset{\textbf{x} \sim \mu}{\mathbb{E}} \left[f(\textbf{x} )\right] -\underset{\textbf{x}  \sim \nu}{\mathbb{E}} \left[f(\textbf{x} )\right] $$</p>
<p>This state the problem as an optimization problem over the 1-lipschitz functions.
Therefore k-Lipschitz networks allows us to solve this maximization problem.</p>
<p>[1] C. Anil, J. Lucas, et R. Grosse, « Sorting out Lipschitz function approximation », arXiv:1811.05381 [cs, stat], nov. 2018.</p>
<p>We will illustrate this on a synthetic image dataset where <span class="arithmatex">\(W_1\)</span> is known.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="c1"># pip install deel-lip -qqq</span>
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span> 

<span class="kn">from</span> <span class="nn">tensorflow.keras</span> <span class="kn">import</span> <span class="n">backend</span> <span class="k">as</span> <span class="n">K</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">Input</span><span class="p">,</span> <span class="n">Flatten</span><span class="p">,</span> <span class="n">ReLU</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.optimizers</span> <span class="kn">import</span> <span class="n">Adam</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.models</span> <span class="kn">import</span> <span class="n">load_model</span>

<span class="kn">from</span> <span class="nn">deel.lip.layers</span> <span class="kn">import</span> <span class="n">SpectralConv2D</span><span class="p">,</span> <span class="n">SpectralDense</span><span class="p">,</span> <span class="n">FrobeniusDense</span>
<span class="kn">from</span> <span class="nn">deel.lip.activations</span> <span class="kn">import</span> <span class="n">MaxMin</span><span class="p">,</span> <span class="n">GroupSort</span><span class="p">,</span> <span class="n">FullSort</span>
<span class="kn">from</span> <span class="nn">deel.lip.losses</span> <span class="kn">import</span> <span class="n">KR</span><span class="p">,</span> <span class="n">HKR</span>
<span class="kn">from</span> <span class="nn">deel.lip.model</span> <span class="kn">import</span> <span class="n">Model</span>
</code></pre></div>

</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stderr output_text">
<pre>
<code>Matplotlib created a temporary config/cache directory at /tmp/matplotlib-_d1mx9in because the default path (/home/thibaut.boissin/.config/matplotlib) is not a writable directory; it is highly recommended to set the MPLCONFIGDIR environment variable to a writable directory, in particular to speed up the import of Matplotlib and to better support multiprocessing.
2021-09-08 18:20:20.330918: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
</code>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="parameters-input-images">Parameters input images<a class="headerlink" href="#parameters-input-images" title="Permanent link">&para;</a></h3>
<p>The synthetic dataset will be composed image with black or white squares allowing us to check if the computed wasserstein distance is correct. One distribution will be the set of black images, while the other will be the set of images with a square on it. these two distribution are diracs, and the wasserstein distance can be analyticaly computed:</p>
<p>In the case to the two diracs the wasserstein distance is then the L1 distance between the two images.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">img_size</span> <span class="o">=</span> <span class="mi">64</span> 
<span class="n">frac_value</span> <span class="o">=</span> <span class="mf">0.3</span>  <span class="c1"># proportion of the center square</span>
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="generate-images">Generate images<a class="headerlink" href="#generate-images" title="Permanent link">&para;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">generate_toy_images</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span><span class="n">frac</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">v</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    function that generate a single image.</span>

<span class="sd">    Args:</span>
<span class="sd">        shape: shape of the output image</span>
<span class="sd">        frac: proportion of the center square</span>
<span class="sd">        value: value assigned to the center square</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">frac</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">img</span>
    <span class="n">frac</span><span class="o">=</span><span class="n">frac</span><span class="o">**</span><span class="mf">0.5</span>
    <span class="c1">#print(frac)</span>
    <span class="n">l</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">frac</span><span class="p">)</span>
    <span class="n">ldec</span><span class="o">=</span><span class="p">(</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">l</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span>
    <span class="c1">#print(l)</span>
    <span class="n">w</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">frac</span><span class="p">)</span>
    <span class="n">wdec</span><span class="o">=</span><span class="p">(</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">w</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span>
    <span class="n">img</span><span class="p">[</span><span class="n">ldec</span><span class="p">:</span><span class="n">ldec</span><span class="o">+</span><span class="n">l</span><span class="p">,</span><span class="n">wdec</span><span class="p">:</span><span class="n">wdec</span><span class="o">+</span><span class="n">w</span><span class="p">,:]</span><span class="o">=</span><span class="n">v</span>
    <span class="k">return</span> <span class="n">img</span>


<span class="k">def</span> <span class="nf">binary_generator</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span><span class="n">shape</span><span class="p">,</span><span class="n">frac</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    generate a batch with half of black images, hald of images with a white square.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">batch_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(((</span><span class="n">batch_size</span><span class="p">,)</span><span class="o">+</span><span class="p">(</span><span class="n">shape</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float16</span><span class="p">)</span>
    <span class="n">batch_y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">batch_size</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float16</span><span class="p">)</span>
    <span class="n">batch_x</span><span class="p">[</span><span class="n">batch_size</span><span class="o">//</span><span class="mi">2</span><span class="p">:,]</span><span class="o">=</span><span class="n">generate_toy_images</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span><span class="n">frac</span><span class="o">=</span><span class="n">frac</span><span class="p">,</span><span class="n">v</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">batch_y</span><span class="p">[</span><span class="n">batch_size</span><span class="o">//</span><span class="mi">2</span><span class="p">:]</span><span class="o">=</span><span class="mi">1</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">yield</span>  <span class="n">batch_x</span><span class="p">,</span> <span class="n">batch_y</span>


<span class="k">def</span> <span class="nf">ternary_generator</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span><span class="n">shape</span><span class="p">,</span><span class="n">frac</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Same as binary generator, but images can have a white square of value 1, or value -1</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">batch_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(((</span><span class="n">batch_size</span><span class="p">,)</span><span class="o">+</span><span class="p">(</span><span class="n">shape</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float16</span><span class="p">)</span>
    <span class="n">batch_y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">batch_size</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float16</span><span class="p">)</span>
    <span class="n">batch_x</span><span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="n">batch_size</span><span class="o">//</span><span class="mi">4</span><span class="p">:,]</span><span class="o">=</span><span class="n">generate_toy_images</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span><span class="n">frac</span><span class="o">=</span><span class="n">frac</span><span class="p">,</span><span class="n">v</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">batch_x</span><span class="p">[</span><span class="n">batch_size</span><span class="o">//</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="o">*</span><span class="n">batch_size</span><span class="o">//</span><span class="mi">4</span><span class="p">,]</span><span class="o">=</span><span class="n">generate_toy_images</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span><span class="n">frac</span><span class="o">=</span><span class="n">frac</span><span class="p">,</span><span class="n">v</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">batch_y</span><span class="p">[</span><span class="n">batch_size</span><span class="o">//</span><span class="mi">2</span><span class="p">:]</span><span class="o">=</span><span class="mi">1</span>
    <span class="c1">#indexes_shuffle = np.arange(batch_size)</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="c1">#np.random.shuffle(indexes_shuffle)</span>
        <span class="c1">#yield  batch_x[indexes_shuffle,], batch_y[indexes_shuffle,]</span>
        <span class="k">yield</span>  <span class="n">batch_x</span><span class="p">,</span> <span class="n">batch_y</span>
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">display_img</span><span class="p">(</span><span class="n">img</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Display an image</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">img</span><span class="p">,(</span><span class="mi">3</span><span class="p">,))</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

    <span class="n">imgplot</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">((</span><span class="n">img</span><span class="o">*</span><span class="mi">255</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint</span><span class="p">))</span>
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now let's take a look at the generated batches</p>
<h4 id="for-binary-generator">for binary generator<a class="headerlink" href="#for-binary-generator" title="Permanent link">&para;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">test</span><span class="o">=</span><span class="n">binary_generator</span><span class="p">(</span><span class="mi">2</span><span class="p">,(</span><span class="n">img_size</span><span class="p">,</span><span class="n">img_size</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">frac</span><span class="o">=</span><span class="n">frac_value</span><span class="p">)</span>
<span class="n">imgs</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="nb">next</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>

<span class="n">display_img</span><span class="p">(</span><span class="n">imgs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">display_img</span><span class="p">(</span><span class="n">imgs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Norm L2 &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">imgs</span><span class="p">[</span><span class="mi">1</span><span class="p">])))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Norm L2(count pixels) &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">imgs</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">imgs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">]))))</span>
</code></pre></div>

</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>
<code>Norm L2 35.0
Norm L2(count pixels) 35.0
</code>
</pre>
</div>
</div>
<div class="output_area">
<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPsAAAD7CAYAAACscuKmAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjMuNCwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8QVMy6AAAACXBIWXMAAAsTAAALEwEAmpwYAAAMb0lEQVR4nO3dT4yc9X3H8fenNi5pQmMbUsuyoQaBgjgEE1kUFFQRV0RuGgUOCBGlklOh7iWViFopgVZqm0qVyiWEQ1XJAhof2gAlTWz5UOI4RO3JYP4lBsfBSUHYsnErYyXpAdXw7WGebRdr1zuemWfG5fd+SdbO8+zsPl8x+97nmdnheVJVSHr/+5VZDyBpOoxdaoSxS40wdqkRxi41wtilRowVe5JtSQ4nOZLkvkkNJWnyMurf2ZOsAH4C3AYcBZ4FPldVr0xuPEmTsnKMr70ROFJVPwNI8hhwO7Bk7El8B4/Us6rKYuvHOYzfALyxYPlot07SBWicPftQkswBc31vR9K5jRP7MeDyBcsbu3XvUVU7gB3gYbw0S+Mcxj8LXJPkyiSrgLuB3ZMZS9Kkjbxnr6ozSf4IeApYATxaVS9PbDJJEzXyn95G2piH8VLv+ng1XtL/I8YuNcLYpUYYu9QIY5caYexSI4xdaoSxS40wdqkRxi41wtilRhi71Ahjlxph7FIjjF1qhLFLjTB2qRHGLjXC2KVGGLvUCGOXGmHsUiOMXWqEsUuNMHapEcvGnuTRJCeTHFywbm2SvUle7T6u6XdMSeMaZs/+DWDbWevuA/ZV1TXAvm5Z0gVs2dir6l+BU2etvh3Y2d3eCdwx2bEkTdqoz9nXVdXx7vYJYN2E5pHUk5Ev2TyvqupcV2dNMgfMjbsdSeMZdc/+ZpL1AN3Hk0vdsap2VNWWqtoy4rYkTcCose8Gtne3twO7JjOOpL6kaskj8MEdkm8CtwKXAW8CfwF8B3gCuAJ4Hbirqs5+EW+x73XujUkaW1VlsfXLxj5Jxi71b6nYfQed1Ahjlxph7FIjjF1qhLFLjTB2qRHGLjXC2KVGGLvUCGOXGmHsUiOMXWqEsUuNMHapEcYuNcLYpUYYu9QIY5caYexSI4xdaoSxS40wdqkRxi41wtilRhi71IhlY09yeZKnk7yS5OUk93br1ybZm+TV7uOa/seVNKphrvW2HlhfVc8nuQR4DrgD+AJwqqr+Jsl9wJqq+soy38vLP0k9G/nyT1V1vKqe727/AjgEbABuB3Z2d9vJ4BeApAvUeT1nT7IJuAHYD6yrquPdp04A6yY7mqRJWjnsHZN8CPgW8KWq+nnyf0cKVVVLHaInmQPmxh1U0niGumRzkouAPcBTVfW1bt1h4NaqOt49r/9BVX10me/jc3apZyM/Z89gF/4IcGg+9M5uYHt3ezuwa9whJfVnmFfjbwH+DfgR8G63+k8ZPG9/ArgCeB24q6pOLfO93LNLPVtqzz7UYfykGLvUv5EP4yW9Pxi71Ahjlxph7FIjjF1qhLFLjTB2qRHGLjXC2KVGGLvUCGOXGmHsUiOMXWqEsUuNMHapEcYuNcLYpUYYu9QIY5caYexSI4xdaoSxS40wdqkRxi41wtilRgxzrbeLkzyT5KUkLyf5arf+yiT7kxxJ8niSVf2PK2lUw+zZ3wa2VtX1wGZgW5KbgAeAB6vqauAt4J7eppQ0tmVjr4FfdosXdf8K2Ao82a3fCdzRx4CSJmOo5+xJViR5ETgJ7AV+CpyuqjPdXY4CG3qZUNJEDBV7Vb1TVZuBjcCNwLXDbiDJXJIDSQ6MNqKkSTivV+Or6jTwNHAzsDrJyu5TG4FjS3zNjqraUlVbxhlU0niGeTX+I0lWd7c/ANwGHGIQ/Z3d3bYDu3qaUdIEpKrOfYfkYwxegFvB4JfDE1X1V0muAh4D1gIvAL9fVW8v873OvTFJY6uqLLZ+2dgnydil/i0Vu++gkxph7FIjjF1qhLFLjTB2qRHGLjXC2KVGGLvUCGOXGmHsUiOMXWqEsUuNMHapEcYuNcLYpUYYu9QIY5caYexSI4xdaoSxS40wdqkRxi41wtilRhi71AhjlxoxdOzdZZtfSLKnW74yyf4kR5I8nmRVf2NKGtf57NnvZXBBx3kPAA9W1dXAW8A9kxxM0mQNFXuSjcDvAQ93ywG2Ak92d9kJ3NHDfJImZNg9+9eBLwPvdsuXAqer6ky3fBTYMNnRJE3SMNdn/wxwsqqeG2UDSeaSHEhyYJSvlzQZK4e4zyeAzyb5NHAx8OvAQ8DqJCu7vftG4NhiX1xVO4Ad4CWbpVlads9eVfdX1caq2gTcDXy/qj4PPA3c2d1tO7CrtykljW2cv7N/BfjjJEcYPId/ZDIjSepDqqZ3ZO1hvNS/qspi630HndQIY5caYexSI4xdaoSxS40wdqkRxi41wtilRhi71Ahjlxph7FIjjF1qhLFLjTB2qRHGLjXC2KVGGLvUCGOXGmHsUiOMXWqEsUuNMHapEcYuNcLYpUYYu9SIYS7sSJLXgF8A7wBnqmpLkrXA48Am4DXgrqp6q58xJY3rfPbsn6yqzVW1pVu+D9hXVdcA+7plSReocQ7jbwd2drd3AneMPY2k3gwbewHfTfJckrlu3bqqOt7dPgGsm/h0kiZmqOfswC1VdSzJbwB7k/x44Serqpa6Qmv3y2Fusc9Jmp7zvmRzkr8Efgn8IXBrVR1Psh74QVV9dJmv9ZLNUs9GvmRzkg8muWT+NvAp4CCwG9je3W07sGsyo0rqw7J79iRXAd/uFlcC/1hVf53kUuAJ4ArgdQZ/eju1zPdyzy71bKk9+3kfxo/D2KX+jXwYL+n9wdilRhi71Ahjlxph7FIjjF1qhLFLjTB2qRHGLjXC2KVGGLvUCGOXGmHsUiOMXWqEsUuNMHapEcYuNcLYpUYYu9QIY5caYexSI4xdaoSxS40wdqkRxi41YqjYk6xO8mSSHyc5lOTmJGuT7E3yavdxTd/DShrdsHv2h4B/qaprgeuBQ8B9wL6qugbY1y1LukANc2HHDwMvAlfVgjsnOYyXbJYuOONc6+1K4D+Av0/yQpKHu0s3r6uq4919TgDrJjOqpD4ME/tK4OPA31XVDcB/cdYhe7fHX3SvnWQuyYEkB8YdVtLohon9KHC0qvZ3y08yiP/N7vCd7uPJxb64qnZU1Zaq2jKJgSWNZtnYq+oE8EaS+efjvwO8AuwGtnfrtgO7eplQ0kQs+wIdQJLNwMPAKuBnwB8w+EXxBHAF8DpwV1WdWub7+AKd1LOlXqAbKvZJMXapf+O8Gi/pfcDYpUYYu9QIY5caYexSI4xdaoSxS41YOeXt/SeDN+Bc1t2epQthBnCOsznHe53vHL+51Cem+qaa/91ocmDW75W/EGZwDueY5hwexkuNMHapEbOKfceMtrvQhTADOMfZnOO9JjbHTJ6zS5o+D+OlRkw19iTbkhxOciTJ1M5Gm+TRJCeTHFywbuqnwk5yeZKnk7yS5OUk985iliQXJ3kmyUvdHF/t1l+ZZH/3+DyeZFWfcyyYZ0V3fsM9s5ojyWtJfpTkxflTqM3oZ6S307ZPLfYkK4C/BX4XuA74XJLrprT5bwDbzlo3i1NhnwH+pKquA24Cvtj9N5j2LG8DW6vqemAzsC3JTcADwINVdTXwFnBPz3PMu5fB6cnnzWqOT1bV5gV/6prFz0h/p22vqqn8A24GnlqwfD9w/xS3vwk4uGD5MLC+u70eODytWRbMsAu4bZazAL8GPA/8FoM3b6xc7PHqcfsbux/grcAeIDOa4zXgsrPWTfVxAT4M/Dvda2mTnmOah/EbgDcWLB/t1s3KTE+FnWQTcAOwfxazdIfOLzI4Uehe4KfA6ao6091lWo/P14EvA+92y5fOaI4CvpvkuSRz3bppPy69nrbdF+g496mw+5DkQ8C3gC9V1c9nMUtVvVNVmxnsWW8Eru17m2dL8hngZFU9N+1tL+KWqvo4g6eZX0zy2ws/OaXHZazTti9nmrEfAy5fsLyxWzcrQ50Ke9KSXMQg9H+oqn+e5SwAVXUaeJrB4fLqJPP/v8Q0Hp9PAJ9N8hrwGIND+YdmMAdVdaz7eBL4NoNfgNN+XMY6bftyphn7s8A13Sutq4C7GZyOelamfirsJAEeAQ5V1ddmNUuSjyRZ3d3+AIPXDQ4xiP7Oac1RVfdX1caq2sTg5+H7VfX5ac+R5INJLpm/DXwKOMiUH5fq+7Ttfb/wcdYLDZ8GfsLg+eGfTXG73wSOA//N4LfnPQyeG+4DXgW+B6ydwhy3MDgE+yGD6+e92P03meoswMeAF7o5DgJ/3q2/CngGOAL8E/CrU3yMbgX2zGKObnsvdf9env/ZnNHPyGbgQPfYfAdYM6k5fAed1AhfoJMaYexSI4xdaoSxS40wdqkRxi41wtilRhi71Ij/ARy0X2QY9RxEAAAAAElFTkSuQmCC"
>
</div>
</div>
<div class="output_area">
<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPsAAAD7CAYAAACscuKmAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjMuNCwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8QVMy6AAAACXBIWXMAAAsTAAALEwEAmpwYAAAMqUlEQVR4nO3dUawc5XnG8f9TG5c0obENqWVhqI1AQVwEE1kUFFQRV0RuGgVfIESUSm6Fem5SiaiVEmiltqlUqdyEcFFVsoDGF23AJU1s+aLEcYjaK4MNprFxHJwUhC2DWwFK0gtUw9uLnVMdrGOf9dnZ3WN//590tDPfzu683t1n55vZ8TepKiRd+n5l2gVImgzDLjXCsEuNMOxSIwy71AjDLjVipLAn2ZLkWJLjSR7sqyhJ/ctif2dPsgz4CXAXcAJ4HvhCVb3cX3mS+rJ8hMfeChyvqp8BJHkSuBs4Z9iTeAaPNGZVlfnaR+nGXw28Pmf+RNcmaQkaZcs+lCQzwMy41yPp/EYJ+0ngmjnz67q2D6iq7cB2sBsvTdMo3fjngRuSbEiyArgP2N1PWZL6tugte1WdSfLHwDPAMuCJqjrSW2WSerXon94WtTK78dLYjeNovKSLiGGXGmHYpUYYdqkRhl1qhGGXGmHYpUYYdqkRhl1qhGGXGmHYpUYYdqkRhl1qhGGXGmHYpUYYdqkRhl1qhGGXGmHYpUYYdqkRhl1qhGGXGmHYpUYYdqkRhl1qxIJhT/JEktNJDs9pW51kb5JXuttV4y1T0qiG2bJ/E9hyVtuDwL6qugHY181LWsIWDHtV/Rvw1lnNdwM7uukdwNZ+y5LUt8Xus6+pqlPd9BvAmp7qkTQmi75k86yqqvNdnTXJDDAz6nokjWaxW/Y3k6wF6G5Pn2vBqtpeVZuqatMi1yWpB4sN+25gWze9DdjVTzmSxiVV5+yBDxZIvgXcCVwFvAn8JfBdYCdwLfAacG9VnX0Qb77nOv/KJI2sqjJf+4Jh75Nhl8bvXGH3DDqpEYZdaoRhlxph2KVGGHapEYZdaoRhlxox8rnxLZnkOQmarGTen6YvKW7ZpUYYdqkRhl1qhGGXGmHYpUYYdqkRhl1qhGGXGmHYpUYYdqkRhl1qhGGXGmHYpUYYdqkRhl1qhGGXGmHYpUYsGPYk1yR5NsnLSY4keaBrX51kb5JXuttV4y9X0mINc623tcDaqnohyRXAQWAr8AfAW1X1t0keBFZV1VcXeK6Lelwnh6W6dF1Kw1It+vJPVXWqql7opn8BHAWuBu4GdnSL7WDwBSBpibqgffYk64FbgP3Amqo61d31BrCm39Ik9Wno0WWTfAT4NvDlqvr53G5PVdW5uuhJZoCZUQuVNJqhLtmc5DJgD/BMVX29azsG3FlVp7r9+h9W1ccXeJ6LeqfXffZLl/vsQAavwuPA0dmgd3YD27rpbcCuUYuUND7DHI2/A/h34EfA+13znzHYb98JXAu8BtxbVW8t8FwX9abRLfulq4Ut+1Dd+L4Ydi1VLYTdM+ikRhh2qRGGXWqEYZcaYdilRhh2qRGGXWqEYZcaYdilRhh2qRGGXWqEYZcaYdilRhh2qRGGXWqEYZcaYdilRhh2qRGGXWqEYZcaYdilRhh2qRGGXWqEYZcaYdilRgxzrbfLkzyX5KUkR5J8rWvfkGR/kuNJnkqyYvzlSlqsYbbs7wKbq+pmYCOwJcltwMPAI1V1PfA2cP/YqpQ0sgXDXgO/7GYv6/4K2Aw83bXvALaOo0BJ/Rhqnz3JsiSHgNPAXuCnwDtVdaZb5ARw9VgqlNSLocJeVe9V1UZgHXArcOOwK0gyk+RAkgOLK1FSHy7oaHxVvQM8C9wOrEyyvLtrHXDyHI/ZXlWbqmrTKIVKGs0wR+M/lmRlN/0h4C7gKIPQ39Mttg3YNaYaJfUgVXX+BZJPMDgAt4zBl8POqvrrJNcBTwKrgReB36+qdxd4rvOvbIlb6LXSxSvJtEvoTVXN+49ZMOx9MuxaqloIu2fQSY0w7FIjDLvUCMMuNcKwS40w7FIjDLvUCMMuNcKwS40w7FIjDLvUCMMuNcKwS40w7FIjDLvUCMMuNcKwS40w7FIjDLvUCMMuNcKwS40w7FIjDLvUCMMuNcKwS40YOuzdZZtfTLKnm9+QZH+S40meSrJifGVKGtWFbNkfYHBBx1kPA49U1fXA28D9fRYmqV9DhT3JOuD3gMe6+QCbgae7RXYAW8dQn6SeDLtl/wbwFeD9bv5K4J2qOtPNnwCu7rc0SX0a5vrsnwNOV9XBxawgyUySA0kOLObxkvqxfIhlPgV8PslngcuBXwceBVYmWd5t3dcBJ+d7cFVtB7bDxX/JZulituCWvaoeqqp1VbUeuA/4QVV9EXgWuKdbbBuwa2xVShrZKL+zfxX4kyTHGezDP95PSZLGIVWT61lf7N34Sb5WmqzBD0yXhqqa9x/jGXRSIwy71AjDLjXCsEuNMOxSIwy71AjDLjXCsEuNMOxSIwy71AjDLjXCsEuNMOxSIwy71AjDLjXCsEuNMOxSIwy71AjDLjXCsEuNMOxSIwy71AjDLjXCsEuNGOZab+pcShcSUHuGCnuSV4FfAO8BZ6pqU5LVwFPAeuBV4N6qens8ZUoa1YV04z9dVRuralM3/yCwr6puAPZ185KWqFH22e8GdnTTO4CtI1cjaWyGDXsB30tyMMlM17amqk51028Aa3qvTlJvhj1Ad0dVnUzyG8DeJD+ee2dV1bmu0Np9OczMd5+kybngSzYn+Svgl8AfAXdW1akka4EfVtXHF3is1zyWxmzRl2xO8uEkV8xOA58BDgO7gW3dYtuAXf2UKmkcFtyyJ7kO+E43uxz4p6r6myRXAjuBa4HXGPz09tYCz+WWXRqzc23ZL7gbPwrDLo3forvxki4Nhl1qhGGXGmHYpUYYdqkRhl1qhGGXGmHYpUYYdqkRhl1qhGGXGmHYpUYYdqkRhl1qhGGXGmHYpUYYdqkRhl1qhGGXGmHYpUYYdqkRhl1qhGGXGmHYpUYYdqkRQ4U9ycokTyf5cZKjSW5PsjrJ3iSvdLerxl2spMUbdsv+KPCvVXUjcDNwFHgQ2FdVNwD7unlJS9QwF3b8KHAIuK7mLJzkGF6yWVpyRrnW2wbgv4B/SPJikse6SzevqapT3TJvAGv6KVXSOAwT9uXAJ4G/r6pbgP/hrC57t8Wfd6udZCbJgSQHRi1W0uINE/YTwImq2t/NP80g/G923Xe629PzPbiqtlfVpqra1EfBkhZnwbBX1RvA60lm98d/B3gZ2A1s69q2AbvGUqGkXix4gA4gyUbgMWAF8DPgDxl8UewErgVeA+6tqrcWeB4P0Eljdq4DdEOFvS+GXRq/UY7GS7oEGHapEYZdaoRhlxph2KVGGHapEYZdasTyCa/vvxmcgHNVNz1NS6EGsI6zWccHXWgdv3muOyZ6Us3/rzQ5MO1z5ZdCDdZhHZOsw2681AjDLjViWmHfPqX1zrUUagDrOJt1fFBvdUxln13S5NmNlxox0bAn2ZLkWJLjSSY2Gm2SJ5KcTnJ4TtvEh8JOck2SZ5O8nORIkgemUUuSy5M8l+Slro6vde0bkuzv3p+nkqwYZx1z6lnWjW+4Z1p1JHk1yY+SHJodQm1Kn5GxDds+sbAnWQb8HfC7wE3AF5LcNKHVfxPYclbbNIbCPgP8aVXdBNwGfKl7DSZdy7vA5qq6GdgIbElyG/Aw8EhVXQ+8Ddw/5jpmPcBgePJZ06rj01W1cc5PXdP4jIxv2PaqmsgfcDvwzJz5h4CHJrj+9cDhOfPHgLXd9Frg2KRqmVPDLuCuadYC/BrwAvBbDE7eWD7f+zXG9a/rPsCbgT1AplTHq8BVZ7VN9H0BPgr8J92xtL7rmGQ3/mrg9TnzJ7q2aZnqUNhJ1gO3APunUUvXdT7EYKDQvcBPgXeq6ky3yKTen28AXwHe7+avnFIdBXwvycEkM13bpN+XsQ7b7gE6zj8U9jgk+QjwbeDLVfXzadRSVe9V1UYGW9ZbgRvHvc6zJfkccLqqDk563fO4o6o+yWA380tJfnvunRN6X0Yatn0hkwz7SeCaOfPrurZpGWoo7L4luYxB0P+xqv5lmrUAVNU7wLMMussrk8z+f4lJvD+fAj6f5FXgSQZd+UenUAdVdbK7PQ18h8EX4KTfl5GGbV/IJMP+PHBDd6R1BXAfg+Gop2XiQ2EnCfA4cLSqvj6tWpJ8LMnKbvpDDI4bHGUQ+nsmVUdVPVRV66pqPYPPww+q6ouTriPJh5NcMTsNfAY4zITflxr3sO3jPvBx1oGGzwI/YbB/+OcTXO+3gFPA/zL49ryfwb7hPuAV4PvA6gnUcQeDLth/MLh+3qHuNZloLcAngBe7Og4Df9G1Xwc8BxwH/hn41Qm+R3cCe6ZRR7e+l7q/I7OfzSl9RjYCB7r35rvAqr7q8Aw6qREeoJMaYdilRhh2qRGGXWqEYZcaYdilRhh2qRGGXWrE/wE89HdrXg0aagAAAABJRU5ErkJggg=="
>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="for-ternary-generator">for ternary generator<a class="headerlink" href="#for-ternary-generator" title="Permanent link">&para;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">test</span><span class="o">=</span><span class="n">ternary_generator</span><span class="p">(</span><span class="mi">4</span><span class="p">,(</span><span class="n">img_size</span><span class="p">,</span><span class="n">img_size</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">frac</span><span class="o">=</span><span class="n">frac_value</span><span class="p">)</span>
<span class="n">imgs</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="nb">next</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">display_img</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">imgs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mf">1.0</span><span class="p">))</span> <span class="c1"># we ensure that there is no negative value wehn displaying images</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Norm L2(imgs[2]-imgs[0])&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">imgs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">imgs</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Norm L2(imgs[2]) &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">imgs</span><span class="p">[</span><span class="mi">2</span><span class="p">])))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Norm L2(count pixels) &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">imgs</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">imgs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">==-</span><span class="mi">1</span><span class="p">]))))</span>
</code></pre></div>

</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>
<code>Norm L2(imgs[2]-imgs[0])35.0
Norm L2(imgs[2]) 35.0
Norm L2(count pixels) 35.0
</code>
</pre>
</div>
</div>
<div class="output_area">
<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPsAAAD7CAYAAACscuKmAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjMuNCwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8QVMy6AAAACXBIWXMAAAsTAAALEwEAmpwYAAAMvklEQVR4nO3df6jd9X3H8edric7etvNq60I0smQYKv4xY7lYRSmrzpK5UvOHiFJGGIH7jxuWFTrdYFDYH/WfWv8Yg0t1zR+u6mxdRErbLLWMwYheq7bR1Jo6xYRous3Qbhe6xb73x/mmXMON9+Se7zkn2+f5gHDO93u+x+8bz33e8+Mevt9UFZL+//u1aQ8gaTKMXWqEsUuNMHapEcYuNcLYpUaMFHuS7UleTnIoyd19DSWpf1nr39mTrAN+DNwEHAaeAe6oqpf6G09SX9aPcN+rgUNV9SpAkoeBW4DTxj4zM1Ozs7Mj7FLSezl+/DhLS0tZ6bZRYr8EeGPZ8mHgY+91h9nZWebn50fYpaT3srCwcNrbxv4BXZL5JItJFpeWlsa9O0mnMUrsR4BLly1v6ta9S1UtVNVcVc3NzMyMsDtJoxgl9meArUm2JDkXuB14op+xJPVtze/Zq+pEkj8Gvg2sAx6sqhd7m0xSr0b5gI6q+ibwzZ5mkTRGfoNOaoSxS40wdqkRxi41wtilRhi71Ahjlxph7FIjjF1qhLFLjTB2qRHGLjXC2KVGGLvUCGOXGmHsUiOMXWqEsUuNMHapEcYuNcLYpUYYu9QIY5caYexSI4xdasSqsSd5MMmxJAeWrbswyd4kr3SXF4x3TEmjGuaZ/avA9lPW3Q3sq6qtwL5uWdJZbNXYq+qfgP84ZfUtwO7u+m5gR79jSerbWt+zb6iqo931N4ENPc0jaUxG/oCuqgqo092eZD7JYpLFpaWlUXcnaY3WGvtbSTYCdJfHTrdhVS1U1VxVzc3MzKxxd5JGtdbYnwB2dtd3Anv6GUfSuAzzp7evAf8CfCTJ4SS7gC8CNyV5Bfi9blnSWWz9ahtU1R2nuenGnmeRNEZ+g05qhLFLjTB2qRHGLjXC2KVGGLvUCGOXGmHsUiOMXWqEsUuNMHapEcYuNcLYpUYYu9QIY5caYexSI4xdaoSxS40wdqkRxi41wtilRhi71Ahjlxph7FIjjF1qxDCnf7o0yVNJXkryYpK7uvUXJtmb5JXu8oLxjytprYZ5Zj8BfK6qrgCuAe5McgVwN7CvqrYC+7plSWepVWOvqqNV9f3u+s+Bg8AlwC3A7m6z3cCOMc0oqQdn9J49yWbgKmA/sKGqjnY3vQls6Hc0SX0aOvYkHwC+Dny2qn62/LaqKqBOc7/5JItJFpeWlkYaVtLaDRV7knMYhP5QVX2jW/1Wko3d7RuBYyvdt6oWqmququZmZmb6mFnSGgzzaXyAB4CDVfWlZTc9Aezsru8E9vQ/nqS+rB9im+uAPwR+mOT5bt2fA18EHk2yC3gduG0sE0rqxaqxV9U/AznNzTf2O46kcfEbdFIjjF1qhLFLjTB2qRHGLjXC2KVGGLvUCGOXGmHsUiOMXWqEsUuNMHapEcYuNcLYpUYYu9QIY5caYexSI4xdaoSxS40wdqkRxi41wtilRhi71Ahjlxph7FIjhjnX23lJnk7yQpIXk3yhW78lyf4kh5I8kuTc8Y8raa2GeWb/BXBDVV0JbAO2J7kGuBe4r6ouA94Gdo1tSkkjWzX2GvjPbvGc7l8BNwCPdet3AzvGMaCkfgx7fvZ13RlcjwF7gZ8Ax6vqRLfJYeCSsUwoqRdDxV5V71TVNmATcDVw+bA7SDKfZDHJ4tLS0tqmlDSyM/o0vqqOA08B1wKzSU6e8nkTcOQ091moqrmqmpuZmRllVkkjGObT+IuSzHbX3wfcBBxkEP2t3WY7gT1jmlFSD9avvgkbgd1J1jH45fBoVT2Z5CXg4SR/BTwHPDDGOSWNaNXYq+oHwFUrrH+Vwft3Sf8H+A06qRHGLjXC2KVGGLvUCGOXGmHsUiOMXWqEsUuNMHapEcYuNcLYpUYYu9QIY5caYexSI4xdaoSxS40wdqkRxi41wtilRhi71Ahjlxph7FIjjF1qhLFLjTB2qRFDx96dtvm5JE92y1uS7E9yKMkjSc4d35iSRnUmz+x3MTih40n3AvdV1WXA28CuPgeT1K+hYk+yCfgD4CvdcoAbgMe6TXYDO8Ywn6SeDPvM/mXg88Avu+UPAcer6kS3fBi4pN/RJPVpmPOzfwo4VlXPrmUHSeaTLCZZXFpaWst/QlIPhjk/+3XAp5PcDJwH/AZwPzCbZH337L4JOLLSnatqAVgAuPjii6uXqSWdsVWf2avqnqraVFWbgduB71bVZ4CngFu7zXYCe8Y2paSRjfJ39j8D/jTJIQbv4R/oZyRJ4zDMy/hfqarvAd/rrr8KXN3/SJLGwW/QSY0wdqkRxi41wtilRhi71Ahjlxph7FIjjF1qhLFLjTB2qRHGLjXC2KVGGLvUCGOXGmHsUiOMXWqEsUuNMHapEcYuNcLYpUYYu9QIY5caYexSI4xdaoSxS40Y6owwSV4Dfg68A5yoqrkkFwKPAJuB14Dbqurt8YwpaVRn8sz+iaraVlVz3fLdwL6q2grs65YlnaVGeRl/C7C7u74b2DHyNJLGZtjYC/hOkmeTzHfrNlTV0e76m8CG3qeT1Jthz+J6fVUdSfKbwN4kP1p+Y1VVklrpjt0vh3mA888/f6RhJa3dUM/sVXWkuzwGPM7gVM1vJdkI0F0eO819F6pqrqrmZmZm+pla0hlbNfYk70/ywZPXgU8CB4AngJ3dZjuBPeMaUtLohnkZvwF4PMnJ7f+uqr6V5Bng0SS7gNeB28Y3pqRRrRp7Vb0KXLnC+n8HbhzHUJL65zfopEYYu9QIY5caYexSI4xdaoSxS40wdqkRxi41wtilRhi71Ahjlxph7FIjjF1qhLFLjTB2qRHGLjXC2KVGGLvUCGOXGmHsUiOMXWqEsUuNMHapEcYuNcLYpUYMFXuS2SSPJflRkoNJrk1yYZK9SV7pLi8Y97CS1m7YZ/b7gW9V1eUMTgV1ELgb2FdVW4F93bKks9QwZ3E9H/g48ABAVf13VR0HbgF2d5vtBnaMZ0RJfRjmmX0L8FPgb5M8l+Qr3ambN1TV0W6bNxmc7VXSWWqY2NcDHwX+pqquAv6LU16yV1UBtdKdk8wnWUyyuLS0NOq8ktZomNgPA4eran+3/BiD+N9KshGguzy20p2raqGq5qpqbmZmpo+ZJa3BqrFX1ZvAG0k+0q26EXgJeALY2a3bCewZy4SSerF+yO3+BHgoybnAq8AfMfhF8WiSXcDrwG3jGVFSH4aKvaqeB+ZWuOnGXqeRNDZ+g05qhLFLjTB2qRHGLjXC2KVGGLvUCGOXGpHB19ontLPkpwy+gPNh4N8mtuOVnQ0zgHOcyjne7Uzn+K2qumilGyYa+692mixW1Upf0mlqBudwjknO4ct4qRHGLjViWrEvTGm/y50NM4BznMo53q23Oabynl3S5PkyXmrERGNPsj3Jy0kOJZnY0WiTPJjkWJIDy9ZN/FDYSS5N8lSSl5K8mOSuacyS5LwkTyd5oZvjC936LUn2d4/PI93xC8Yuybru+IZPTmuOJK8l+WGS55Msduum8TMytsO2Tyz2JOuAvwZ+H7gCuCPJFRPa/VeB7aesm8ahsE8An6uqK4BrgDu7/weTnuUXwA1VdSWwDdie5BrgXuC+qroMeBvYNeY5TrqLweHJT5rWHJ+oqm3L/tQ1jZ+R8R22vaom8g+4Fvj2suV7gHsmuP/NwIFlyy8DG7vrG4GXJzXLshn2ADdNcxZgBvg+8DEGX95Yv9LjNcb9b+p+gG8AngQypTleAz58yrqJPi7A+cC/0n2W1vcck3wZfwnwxrLlw926aZnqobCTbAauAvZPY5bupfPzDA4Uuhf4CXC8qk50m0zq8fky8Hngl93yh6Y0RwHfSfJskvlu3aQfl7Eett0P6HjvQ2GPQ5IPAF8HPltVP5vGLFX1TlVtY/DMejVw+bj3eaoknwKOVdWzk973Cq6vqo8yeJt5Z5KPL79xQo/LSIdtX80kYz8CXLpseVO3blqGOhR235KcwyD0h6rqG9OcBaAGZ/d5isHL5dkkJ49LOInH5zrg00leAx5m8FL+/inMQVUd6S6PAY8z+AU46cdlpMO2r2aSsT8DbO0+aT0XuJ3B4ainZeKHwk4SBqfROlhVX5rWLEkuSjLbXX8fg88NDjKI/tZJzVFV91TVpqrazODn4btV9ZlJz5Hk/Uk+ePI68EngABN+XGrch20f9wcfp3zQcDPwYwbvD/9igvv9GnAU+B8Gvz13MXhvuA94BfhH4MIJzHE9g5dgPwCe7/7dPOlZgN8BnuvmOAD8Zbf+t4GngUPA3wO/PsHH6HeBJ6cxR7e/F7p/L5782ZzSz8g2YLF7bP4BuKCvOfwGndQIP6CTGmHsUiOMXWqEsUuNMHapEcYuNcLYpUYYu9SI/wX2pja/9OIdNQAAAABJRU5ErkJggg=="
>
</div>
</div>
<div class="output_area">
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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"
>
</div>
</div>
<div class="output_area">
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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"
>
</div>
</div>
<div class="output_area">
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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"
>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="expe-parameters">Expe parameters<a class="headerlink" href="#expe-parameters" title="Permanent link">&para;</a></h3>
<p>Now we know the wasserstein distance between the black image and the images with a square on it.
For both binary generator and ternary generator this distance is 35.</p>
<p>We will then compute this distance using a neural network.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">batch_size</span><span class="o">=</span><span class="mi">64</span>
<span class="n">epochs</span><span class="o">=</span><span class="mi">5</span>
<span class="n">steps_per_epoch</span><span class="o">=</span><span class="mi">6400</span>
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">generator</span> <span class="o">=</span> <span class="n">ternary_generator</span>   <span class="c1">#binary_generator, ternary_generator</span>
<span class="n">activation</span> <span class="o">=</span> <span class="n">FullSort</span> <span class="c1">#ReLU, MaxMin, GroupSort</span>
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="build-lipschitz-model">Build lipschitz Model<a class="headerlink" href="#build-lipschitz-model" title="Permanent link">&para;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">K</span><span class="o">.</span><span class="n">clear_session</span><span class="p">()</span>
<span class="c1">## please note that the previous helper function has the same behavior as the following code:</span>
<span class="n">inputs</span> <span class="o">=</span> <span class="n">Input</span><span class="p">((</span><span class="n">img_size</span><span class="p">,</span> <span class="n">img_size</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">Flatten</span><span class="p">()(</span><span class="n">inputs</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">SpectralDense</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">FullSort</span><span class="p">())(</span><span class="n">x</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">SpectralDense</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">FullSort</span><span class="p">())(</span><span class="n">x</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">SpectralDense</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">FullSort</span><span class="p">())(</span><span class="n">x</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">FrobeniusDense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="kc">None</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="n">wass</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
<span class="n">wass</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</code></pre></div>

</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stderr output_text">
<pre>
<code>2021-09-08 18:20:38.075170: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-09-08 18:20:38.076265: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-09-08 18:20:38.116402: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-09-08 18:20:38.116842: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3080 computeCapability: 8.6
coreClock: 1.83GHz coreCount: 68 deviceMemorySize: 9.78GiB deviceMemoryBandwidth: 707.88GiB/s
2021-09-08 18:20:38.116868: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-09-08 18:20:38.119558: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-09-08 18:20:38.119602: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-09-08 18:20:38.120389: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-09-08 18:20:38.120583: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-09-08 18:20:38.122025: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-09-08 18:20:38.122661: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-09-08 18:20:38.122768: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-09-08 18:20:38.122832: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-09-08 18:20:38.123234: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-09-08 18:20:38.123588: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 18:20:38.124825: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-09-08 18:20:38.124895: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-09-08 18:20:38.125224: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 3080 computeCapability: 8.6
coreClock: 1.83GHz coreCount: 68 deviceMemorySize: 9.78GiB deviceMemoryBandwidth: 707.88GiB/s
2021-09-08 18:20:38.125241: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-09-08 18:20:38.125254: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-09-08 18:20:38.125266: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-09-08 18:20:38.125278: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-09-08 18:20:38.125289: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-09-08 18:20:38.125300: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-09-08 18:20:38.125311: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-09-08 18:20:38.125323: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-09-08 18:20:38.125366: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-09-08 18:20:38.125711: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-09-08 18:20:38.126022: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-09-08 18:20:38.126048: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-09-08 18:20:38.409201: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-08 18:20:38.409221: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-09-08 18:20:38.409225: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-09-08 18:20:38.409352: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-09-08 18:20:38.409615: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-09-08 18:20:38.409848: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-09-08 18:20:38.410069: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 9056 MB memory) -&gt; physical GPU (device: 0, name: GeForce RTX 3080, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-09-08 18:20:38.493063: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-09-08 18:20:38.861293: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-09-08 18:20:38.861380: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
</code>
</pre>
</div>
</div>
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>
<code>Model: &#34;model&#34;
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 64, 64, 1)]       0         
_________________________________________________________________
flatten (Flatten)            (None, 4096)              0         
_________________________________________________________________
spectral_dense (SpectralDens (None, 128)               1048833   
_________________________________________________________________
spectral_dense_1 (SpectralDe (None, 64)                16513     
_________________________________________________________________
spectral_dense_2 (SpectralDe (None, 32)                4161      
_________________________________________________________________
frobenius_dense (FrobeniusDe (None, 1)                 65        
=================================================================
Total params: 1,069,572
Trainable params: 534,785
Non-trainable params: 534,787
_________________________________________________________________
</code>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">optimizer</span> <span class="o">=</span> <span class="n">Adam</span><span class="p">(</span><span class="n">lr</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">wass</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="n">HKR</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">KR</span><span class="p">])</span>
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="learn-on-toy-dataset">Learn on toy dataset<a class="headerlink" href="#learn-on-toy-dataset" title="Permanent link">&para;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">wass</span><span class="o">.</span><span class="n">fit_generator</span><span class="p">(</span> <span class="n">generator</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,(</span><span class="n">img_size</span><span class="p">,</span><span class="n">img_size</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">frac</span><span class="o">=</span><span class="n">frac_value</span><span class="p">),</span>
                <span class="n">steps_per_epoch</span><span class="o">=</span><span class="n">steps_per_epoch</span><span class="o">//</span> <span class="n">batch_size</span><span class="p">,</span>
                <span class="n">epochs</span><span class="o">=</span><span class="n">epochs</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>

</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stderr output_text">
<pre>
<code>/home/thibaut.boissin/envs/tf24/lib/python3.7/site-packages/tensorflow/python/keras/engine/training.py:1844: UserWarning: `Model.fit_generator` is deprecated and will be removed in a future version. Please use `Model.fit`, which supports generators.
  warnings.warn(&#39;`Model.fit_generator` is deprecated and &#39;
2021-09-08 18:20:39.823710: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-09-08 18:20:39.842379: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 3600000000 Hz
</code>
</pre>
</div>
</div>
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>
<code>Epoch 1/5
100/100 [==============================] - 6s 50ms/step - loss: -24.9882 - KR: 24.9882
Epoch 2/5
100/100 [==============================] - 5s 49ms/step - loss: -34.9959 - KR: 34.9959
Epoch 3/5
100/100 [==============================] - 5s 49ms/step - loss: -34.9964 - KR: 34.9964
Epoch 4/5
100/100 [==============================] - 5s 50ms/step - loss: -34.9961 - KR: 34.9961
Epoch 5/5
100/100 [==============================] - 5s 50ms/step - loss: -34.9957 - KR: 34.9957
</code>
</pre>
</div>
</div>
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>
<code>&lt;tensorflow.python.keras.callbacks.History at 0x7f6a6b73cfd0&gt;</code>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As we can see the loss converge to the value 35 which is the wasserstein distance between the two distributions (square and non-square).</p>
</div>
</div>
</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.2a6f1dda.min.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="../../js/custom.js"></script>
      
    
  </body>
</html>